{
    "sourceFile": "app/Http/Controllers/Main/PemeliharaanSaranaController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1705472195541,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1705472643401,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -103,22 +103,22 @@\n      */\n     public function edit(string $id)\n     {\n \n-        $row = PembelianSarpras::findOrFail($id);\n+        $row = PemeliharaanSarana::findOrFail($id);\n         $user = User::all();\n-        $jenis_kebutuhan = JenisKebutuhan::all();\n-        return view('main.pembelian_sarpras.edit', [\n-            'title' => 'Edit Data Sarpras',\n+        $sarana = Sarana::all();\n+        $sarana = PemeliharaanSarana::all();\n+        return view('main.pemeliharaan_sarana.edit', [\n+            'title' => 'Edit Data Sarana',\n             'user' => $user,\n             'id' => $row->id,\n-            'nama' => $row->nama,\n-            'jenis_kebutuhan' => $jenis_kebutuhan,\n-            'spesifikasi' => $row->spesifikasi,\n+            'sarana' => $sarana,\n+            'unit' => $row->unit,\n             'jumlah' => $row->jumlah,\n-            'harga_satuan' => $row->harga_satuan,\n+            'keterangan' => $row->keterangan,\n+            'tanggal' => $row->tanggal,\n             'status' => $row->status,\n-            'tanggal' => $row->tanggal,\n         ]);\n     }\n \n     /**\n@@ -126,19 +126,16 @@\n      */\n     public function update(Request $request, string $id)\n     {\n         $request->validate([\n-            // 'file1' => 'required|mimes:jpg,png|max:5048',\n-            // 'file2' => 'required|mimes:jpg,png|max:5048',\n-            // 'file3' => 'required|mimes:jpg,png|max:5048',\n+            // 'file' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n-            'nama' => 'required',\n-            'jenis_kebutuhan' => 'required',\n-            'spesifikasi' => 'required',\n+            'sarana_id' => 'required',\n+            'unit' => 'required',\n             'jumlah' => 'required',\n-            'harga_satuan' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n             'status' => 'required',\n-            'tanggal' => 'required',\n         ]);\n         // // Proses pengunggahan berkas pertama\n         // $file1 = $request->file('file1');\n         // $file1Name = time() . '_' . $file1->getClientOriginalName();\n"
                },
                {
                    "date": 1705472855134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -141,28 +141,27 @@\n         // $file1Name = time() . '_' . $file1->getClientOriginalName();\n         // $file1->move(public_path('uploads'), $file1Name);\n \n         // // Proses pengunggahan berkas kedua\n-        // $file2 = $request->file('file2');\n-        // $file2Name = time() . '_' . $file2->getClientOriginalName();\n-        // $file2->move(public_path('uploads'), $file2Name);\n+        // $file = $request->file('file');\n+        // $fileName = time() . '_' . $file2->getClientOriginalName();\n+        // $file->move(public_path('uploads'), $fileName);\n \n         // // Proses pengunggahan berkas ketiga\n         // $file3 = $request->file('file3');\n         // $file3Name = time() . '_' . $file3->getClientOriginalName();\n         // $file3->move(public_path('uploads'), $file3Name);\n \n-        $fileModel = PembelianSarpras::find($id);\n+        $fileModel = PemeliharaanSarana::find($id);\n         $fileModel->user_id = $request->user_id;\n-        $fileModel->nama = $request->nama;\n-        $fileModel->jenis_kebutuhan = $request->jenis_kebutuhan;\n-        $fileModel->spesifikasi = $request->spesifikasi;\n+        $fileModel->sarana_id = $request->sarana_id;\n+        $fileModel->unit = $request->unit;\n         $fileModel->jumlah = $request->jumlah;\n-        $fileModel->harga_satuan = $request->harga_satuan;\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->tanggal = $request->tanggal;\n         // $fileModel->gambar_katalog = $file1Name;\n-        // $fileModel->paraf_kapokja = $file2Name;\n+        // $fileModel->unit = $fileName;\n         // $fileModel->gambar_pembelian = $file3Name;\n \n         $fileModel->save();\n \n@@ -174,17 +173,13 @@\n      */\n     public function destroy(string $id)\n     {\n \n-        $data = PembelianSarpras::findOrFail($id);\n-        $image_path = \"/uploads/\" . $data->paraf_kapokja;\n-        $gambar_katalog = \"/uploads/\" . $data->gambar_katalog;\n-        $gambar_pembelian = \"/uploads/\" . $data->gambar_pembelian;\n+        $data = PemeliharaanSarana::findOrFail($id);\n+        $file_path = \"/uploads/\" . $data->unit;\n \n-        if (file_exists($image_path)) {\n-            @unlink($image_path);\n-            @unlink($gambar_katalog);\n-            @unlink($gambar_pembelian);\n+        if (file_exists($file_path)) {\n+            @unlink($file_path);\n         }\n         $data->delete();\n         return back()->with('hapus', 'Data sudah di Hapus!');\n     }\n"
                },
                {
                    "date": 1705540795182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,186 +0,0 @@\n-<?php\n-\n-namespace App\\Http\\Controllers\\Main;\n-\n-use App\\Http\\Controllers\\Controller;\n-use App\\Models\\Sarana;\n-use App\\Models\\PemeliharaanSarana;\n-use App\\Models\\User;\n-use Faker\\Core\\File;\n-use Illuminate\\Http\\Request;\n-\n-class PemeliharaanSaranaController extends Controller\n-{\n-    /**\n-     * Display a listing of the resource.\n-     */\n-    public function index()\n-    {\n-        if ($user = auth()->user()->jab_id == 4) {\n-            $user = auth()->user()->id;\n-            $data['title'] = 'Data Pemeliharaan Sarana';\n-            $user = PemeliharaanSarana::with('users', 'saranas')\n-                ->where('user_id', $user)\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pemeliharaan_sarana.index', $data);\n-        } else {\n-            $data['title'] = 'Data Pemeliharaan Sarana';\n-            $user = PemeliharaanSarana::with('users', 'saranas')\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pemeliharaan_sarana.index', $data);\n-        }\n-    }\n-\n-    /**\n-     * Show the form for creating a new resource.\n-     */\n-    public function create()\n-    {\n-        $data['user'] = User::all();\n-        $data['sarana'] = Sarana::all();\n-        $data['title'] = \"Tambah Data Sarana\";\n-        return view(\"main.pemeliharaan_sarana.create\", $data);\n-    }\n-\n-    /**\n-     * Store a newly created resource in storage.\n-     */\n-    public function store(Request $request)\n-    {\n-        $request->validate([\n-            'file' => 'required|mimes:jpg,png,pdf|max:5048',\n-            'user_id' => 'required',\n-            'sarana_id' => 'required',\n-            'unit' => 'required',\n-            'jumlah' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // Proses pengunggahan berkas\n-        $file = $request->file('file');\n-        $fileName = time() . '_' . $file->getClientOriginalName();\n-        $file->move(public_path('uploads'), $fileName);\n-\n-\n-\n-        $fileModel = new PemeliharaanSarana();\n-\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->sarana_id = $request->sarana_id;\n-        $fileModel->unit = $fileName;\n-        $fileModel->jumlah = $request->jumlah;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-\n-        $fileModel->save();\n-        return redirect('main/pembelian_sarpras')->with('success', 'Data berhasil di simpan.');\n-    }\n-\n-    /**\n-     * Display the specified resource.\n-     */\n-    public function show(string $id)\n-    {\n-\n-        $row = PemeliharaanSarana::findOrFail($id);\n-        return view('main.pemeliharaan_sarana.show', [\n-            'title' => 'Detail Data Pemeliharaan Sarana',\n-            'sarana_id' => $row->sarana_id,\n-            'unit' => $row->unit,\n-            'jumlah' => $row->jumlah,\n-            'keterangan' => $row->keterangan,\n-            'tanggal' => $row->tanggal,\n-        ]);\n-    }\n-\n-    /**\n-     * Show the form for editing the specified resource.\n-     */\n-    public function edit(string $id)\n-    {\n-\n-        $row = PemeliharaanSarana::findOrFail($id);\n-        $user = User::all();\n-        $sarana = Sarana::all();\n-        $sarana = PemeliharaanSarana::all();\n-        return view('main.pemeliharaan_sarana.edit', [\n-            'title' => 'Edit Data Sarana',\n-            'user' => $user,\n-            'id' => $row->id,\n-            'sarana' => $sarana,\n-            'unit' => $row->unit,\n-            'jumlah' => $row->jumlah,\n-            'keterangan' => $row->keterangan,\n-            'tanggal' => $row->tanggal,\n-            'status' => $row->status,\n-        ]);\n-    }\n-\n-    /**\n-     * Update the specified resource in storage.\n-     */\n-    public function update(Request $request, string $id)\n-    {\n-        $request->validate([\n-            // 'file' => 'required|mimes:jpg,png,pdf|max:5048',\n-            'user_id' => 'required',\n-            'sarana_id' => 'required',\n-            'unit' => 'required',\n-            'jumlah' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // // Proses pengunggahan berkas pertama\n-        // $file1 = $request->file('file1');\n-        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        // $file1->move(public_path('uploads'), $file1Name);\n-\n-        // // Proses pengunggahan berkas kedua\n-        // $file = $request->file('file');\n-        // $fileName = time() . '_' . $file2->getClientOriginalName();\n-        // $file->move(public_path('uploads'), $fileName);\n-\n-        // // Proses pengunggahan berkas ketiga\n-        // $file3 = $request->file('file3');\n-        // $file3Name = time() . '_' . $file3->getClientOriginalName();\n-        // $file3->move(public_path('uploads'), $file3Name);\n-\n-        $fileModel = PemeliharaanSarana::find($id);\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->sarana_id = $request->sarana_id;\n-        $fileModel->unit = $request->unit;\n-        $fileModel->jumlah = $request->jumlah;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-        // $fileModel->gambar_katalog = $file1Name;\n-        // $fileModel->unit = $fileName;\n-        // $fileModel->gambar_pembelian = $file3Name;\n-\n-        $fileModel->save();\n-\n-        return redirect('main/pembelian_sarpras')->with('success', 'Data berhasil diubah');\n-    }\n-\n-    /**\n-     * Remove the specified resource from storage.\n-     */\n-    public function destroy(string $id)\n-    {\n-\n-        $data = PemeliharaanSarana::findOrFail($id);\n-        $file_path = \"/uploads/\" . $data->unit;\n-\n-        if (file_exists($file_path)) {\n-            @unlink($file_path);\n-        }\n-        $data->delete();\n-        return back()->with('hapus', 'Data sudah di Hapus!');\n-    }\n-}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1705472195541,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\Sarana;\nuse App\\Models\\PemeliharaanSarana;\nuse App\\Models\\User;\nuse Faker\\Core\\File;\nuse Illuminate\\Http\\Request;\n\nclass PemeliharaanSaranaController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        if ($user = auth()->user()->jab_id == 4) {\n            $user = auth()->user()->id;\n            $data['title'] = 'Data Pemeliharaan Sarana';\n            $user = PemeliharaanSarana::with('users', 'saranas')\n                ->where('user_id', $user)\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pemeliharaan_sarana.index', $data);\n        } else {\n            $data['title'] = 'Data Pemeliharaan Sarana';\n            $user = PemeliharaanSarana::with('users', 'saranas')\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pemeliharaan_sarana.index', $data);\n        }\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['user'] = User::all();\n        $data['sarana'] = Sarana::all();\n        $data['title'] = \"Tambah Data Sarana\";\n        return view(\"main.pemeliharaan_sarana.create\", $data);\n    }\n\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n        $request->validate([\n            'file' => 'required|mimes:jpg,png,pdf|max:5048',\n            'user_id' => 'required',\n            'sarana_id' => 'required',\n            'unit' => 'required',\n            'jumlah' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // Proses pengunggahan berkas\n        $file = $request->file('file');\n        $fileName = time() . '_' . $file->getClientOriginalName();\n        $file->move(public_path('uploads'), $fileName);\n\n\n\n        $fileModel = new PemeliharaanSarana();\n\n        $fileModel->user_id = $request->user_id;\n        $fileModel->sarana_id = $request->sarana_id;\n        $fileModel->unit = $fileName;\n        $fileModel->jumlah = $request->jumlah;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n\n        $fileModel->save();\n        return redirect('main/pembelian_sarpras')->with('success', 'Data berhasil di simpan.');\n    }\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n\n        $row = PemeliharaanSarana::findOrFail($id);\n        return view('main.pemeliharaan_sarana.show', [\n            'title' => 'Detail Data Pemeliharaan Sarana',\n            'sarana_id' => $row->sarana_id,\n            'unit' => $row->unit,\n            'jumlah' => $row->jumlah,\n            'keterangan' => $row->keterangan,\n            'tanggal' => $row->tanggal,\n        ]);\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n\n        $row = PembelianSarpras::findOrFail($id);\n        $user = User::all();\n        $jenis_kebutuhan = JenisKebutuhan::all();\n        return view('main.pembelian_sarpras.edit', [\n            'title' => 'Edit Data Sarpras',\n            'user' => $user,\n            'id' => $row->id,\n            'nama' => $row->nama,\n            'jenis_kebutuhan' => $jenis_kebutuhan,\n            'spesifikasi' => $row->spesifikasi,\n            'jumlah' => $row->jumlah,\n            'harga_satuan' => $row->harga_satuan,\n            'status' => $row->status,\n            'tanggal' => $row->tanggal,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n        $request->validate([\n            // 'file1' => 'required|mimes:jpg,png|max:5048',\n            // 'file2' => 'required|mimes:jpg,png|max:5048',\n            // 'file3' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'nama' => 'required',\n            'jenis_kebutuhan' => 'required',\n            'spesifikasi' => 'required',\n            'jumlah' => 'required',\n            'harga_satuan' => 'required',\n            'status' => 'required',\n            'tanggal' => 'required',\n        ]);\n        // // Proses pengunggahan berkas pertama\n        // $file1 = $request->file('file1');\n        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n        // $file1->move(public_path('uploads'), $file1Name);\n\n        // // Proses pengunggahan berkas kedua\n        // $file2 = $request->file('file2');\n        // $file2Name = time() . '_' . $file2->getClientOriginalName();\n        // $file2->move(public_path('uploads'), $file2Name);\n\n        // // Proses pengunggahan berkas ketiga\n        // $file3 = $request->file('file3');\n        // $file3Name = time() . '_' . $file3->getClientOriginalName();\n        // $file3->move(public_path('uploads'), $file3Name);\n\n        $fileModel = PembelianSarpras::find($id);\n        $fileModel->user_id = $request->user_id;\n        $fileModel->nama = $request->nama;\n        $fileModel->jenis_kebutuhan = $request->jenis_kebutuhan;\n        $fileModel->spesifikasi = $request->spesifikasi;\n        $fileModel->jumlah = $request->jumlah;\n        $fileModel->harga_satuan = $request->harga_satuan;\n        $fileModel->status = $request->status;\n        $fileModel->tanggal = $request->tanggal;\n        // $fileModel->gambar_katalog = $file1Name;\n        // $fileModel->paraf_kapokja = $file2Name;\n        // $fileModel->gambar_pembelian = $file3Name;\n\n        $fileModel->save();\n\n        return redirect('main/pembelian_sarpras')->with('success', 'Data berhasil diubah');\n    }\n\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n\n        $data = PembelianSarpras::findOrFail($id);\n        $image_path = \"/uploads/\" . $data->paraf_kapokja;\n        $gambar_katalog = \"/uploads/\" . $data->gambar_katalog;\n        $gambar_pembelian = \"/uploads/\" . $data->gambar_pembelian;\n\n        if (file_exists($image_path)) {\n            @unlink($image_path);\n            @unlink($gambar_katalog);\n            @unlink($gambar_pembelian);\n        }\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n}\n"
        }
    ]
}