{
    "sourceFile": "app/Http/Controllers/Main/PengelolaanPersuratanController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 44,
            "patches": [
                {
                    "date": 1704864025101,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1704867575298,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,8 +7,9 @@\n use App\\Models\\Pegawai;\n use App\\Models\\PengelolaanPersuratan;\n use App\\Models\\User;\n use Illuminate\\Http\\Request;\n+use Illuminate\\Support\\Facades\\DB as FacadesDB;\n \n class PengelolaanPersuratanController extends Controller\n {\n     /**\n"
                },
                {
                    "date": 1705303979151,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,9 +52,9 @@\n      */\n     public function store(Request $request)\n     {\n         $request->validate([\n-            'file1' => 'required|mimes:jpg,png|max:5048',\n+            'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n             'surat_id' => 'required',\n             'pegawai_id' => 'required',\n             'keterangan' => 'required',\n@@ -161,12 +161,12 @@\n     public function destroy(string $id)\n     {\n \n         $data = PengelolaanPersuratan::findOrFail($id);\n-        $image_path = \"/uploads/\" . $data->lampiran;\n+        $file_path = \"/uploads/\" . $data->lampiran;\n \n-        if (file_exists($image_path)) {\n-            @unlink($image_path);\n+        if (file_exists($file_path)) {\n+            @unlink($file_path);\n         }\n         $data->delete();\n         return back()->with('hapus', 'Data sudah di Hapus!');\n     }\n"
                },
                {
                    "date": 1705343879721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n         $row = PengelolaanPersuratan::findOrFail($id);\n         return view('main.pengelolaan_persuratan.show', [\n             'title' => 'Detail Data Pengelolaan Persuratan',\n             'surat_id' => $row->surat_id,\n-            'pegawai_id' => $row->pegawai_id,\n+            'pegawai_id' => is_array($row->pegawai_id) ? implode(', ', $row->pegawai_id) : $row->pegawai_id,\n             'keterangan' => $row->keterangan,\n             'lampiran' => $row->lampiran,\n             'tanggal' => $row->tanggal,\n         ]);\n"
                },
                {
                    "date": 1705343998545,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n         $row = PengelolaanPersuratan::findOrFail($id);\n         return view('main.pengelolaan_persuratan.show', [\n             'title' => 'Detail Data Pengelolaan Persuratan',\n             'surat_id' => $row->surat_id,\n-            'pegawai_id' => is_array($row->pegawai_id) ? implode(', ', $row->pegawai_id) : $row->pegawai_id,\n+            'pegawai_id' => $row->pegawai_id,\n             'keterangan' => $row->keterangan,\n             'lampiran' => $row->lampiran,\n             'tanggal' => $row->tanggal,\n         ]);\n"
                },
                {
                    "date": 1705344052937,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,9 +144,9 @@\n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->pegawai_id = is_array($request->pegawai_id) ? implode(', ', $request->pegawai_id) : $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705344202386,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->pegawai_id = is_array($request->pegawai_id) ? implode(', ', $request->pegawai_id) : $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705344799735,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = is_array($request->pegawai_id) ? implode(', ', $request->pegawai_id) : $request->pegawai_id;\n+        $fileModel->pegawai_id = $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n@@ -144,9 +144,9 @@\n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = is_array($request->pegawai_id) ? implode(', ', $request->pegawai_id) : $request->pegawai_id;\n+        $fileModel->pegawai_id = $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705361630352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->Pegawai_id = $request->input('pegawai_id');\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705361867264,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->Pegawai_id = $request->input('pegawai_id');\n+        $selectedPegawais = $request->input('pegawai_id');\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705361922278,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $selectedPegawais = $request->input('pegawai_id');\n+        $fileModel->Pegawai_id = $request->input('pegawai_id');\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705361960372,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->Pegawai_id = $request->input('pegawai_id');\n+        $fileModel->pegawai_id = $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705370814677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->pegawai_id = json_encode($request->pokja);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705370886759,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = json_encode($request->pokja);\n+        $fileModel->pegawai_id = json_encode($request->pegawai_id);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705371073889,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = json_encode($request->pegawai_id);\n+        $fileModel->pegawai_id = $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705372803162,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->pegawai_id = json_encode($request->pegawai_id);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705372969042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = json_encode($request->pegawai_id);\n+        $fileModel->pegawai_id = $request->pegawai_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705373516495,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,10 +2,8 @@\n \n namespace App\\Http\\Controllers\\Main;\n \n use App\\Http\\Controllers\\Controller;\n-use App\\Models\\Surat;\n-use App\\Models\\Pegawai;\n use App\\Models\\PengelolaanPersuratan;\n use App\\Models\\User;\n use Illuminate\\Http\\Request;\n use Illuminate\\Support\\Facades\\DB as FacadesDB;\n@@ -19,16 +17,16 @@\n     {\n         if ($user = auth()->user()->jab_id == 4) {\n             $user = auth()->user()->id;\n             $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users', 'surat', 'pegawai')\n+            $user = PengelolaanPersuratan::with('users')\n                 ->where('user_id', $user)\n                 ->get();\n             $data['result'] = $user->sortDesc();\n             return view('main.pengelolaan_persuratan.index', $data);\n         } else {\n             $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users', 'surat', 'pegawai')\n+            $user = PengelolaanPersuratan::with('users')\n                 ->get();\n             $data['result'] = $user->sortDesc();\n             return view('main.pengelolaan_persuratan.index', $data);\n         }\n@@ -39,10 +37,8 @@\n      */\n     public function create()\n     {\n         $data['user'] = User::all();\n-        $data['surat'] = Surat::all();\n-        $data['pegawai'] = Pegawai::all();\n         $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n         $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n         return view(\"main.pengelolaan_persuratan.create\", $data);\n     }\n@@ -54,10 +50,10 @@\n     {\n         $request->validate([\n             'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai_id' => 'required',\n+            'surat' => 'required',\n+            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n@@ -69,10 +65,10 @@\n \n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->surat = $request->surat;\n+        $fileModel->pegawai = $request->pegawai;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n@@ -89,10 +85,10 @@\n \n         $row = PengelolaanPersuratan::findOrFail($id);\n         return view('main.pengelolaan_persuratan.show', [\n             'title' => 'Detail Data Pengelolaan Persuratan',\n-            'surat_id' => $row->surat_id,\n-            'pegawai_id' => $row->pegawai_id,\n+            'surat' => $row->surat,\n+            'pegawai' => $row->pegawai,\n             'keterangan' => $row->keterangan,\n             'lampiran' => $row->lampiran,\n             'tanggal' => $row->tanggal,\n         ]);\n@@ -105,16 +101,14 @@\n     {\n \n         $row = PengelolaanPersuratan::findOrFail($id);\n         $user = User::all();\n-        $surat = Surat::all();\n-        $pegawai = Pegawai::all();\n         return view('main.pengelolaan_persuratan.edit', [\n             'title' => 'Edit Data Surat',\n             'user' => $user,\n             'id' => $row->id,\n-            'surat' => $surat,\n-            'pegawai' => $pegawai,\n+            'surat' => $row->surat,\n+            'pegawai' => $row->pegawai,\n             'keterangan' => $row->keterangan,\n             'tanggal' => $row->tanggal,\n             'status' => $row->status,\n         ]);\n@@ -129,10 +123,10 @@\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai_id' => 'required',\n+            'surat' => 'required',\n+            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n@@ -143,10 +137,10 @@\n \n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->surat = $request->surat;\n+        $fileModel->pegawai = $request->pegawai;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705374037569,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n \n namespace App\\Http\\Controllers\\Main;\n \n use App\\Http\\Controllers\\Controller;\n+use App\\Models\\Surat;\n use App\\Models\\PengelolaanPersuratan;\n use App\\Models\\User;\n use Illuminate\\Http\\Request;\n use Illuminate\\Support\\Facades\\DB as FacadesDB;\n@@ -17,16 +18,16 @@\n     {\n         if ($user = auth()->user()->jab_id == 4) {\n             $user = auth()->user()->id;\n             $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users')\n+            $user = PengelolaanPersuratan::with('users', 'surat')\n                 ->where('user_id', $user)\n                 ->get();\n             $data['result'] = $user->sortDesc();\n             return view('main.pengelolaan_persuratan.index', $data);\n         } else {\n             $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users')\n+            $user = PengelolaanPersuratan::with('users', 'surat')\n                 ->get();\n             $data['result'] = $user->sortDesc();\n             return view('main.pengelolaan_persuratan.index', $data);\n         }\n@@ -37,8 +38,9 @@\n      */\n     public function create()\n     {\n         $data['user'] = User::all();\n+        $data['surat'] = Surat::all();\n         $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n         $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n         return view(\"main.pengelolaan_persuratan.create\", $data);\n     }\n@@ -50,9 +52,9 @@\n     {\n         $request->validate([\n             'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n-            'surat' => 'required',\n+            'surat_id' => 'required',\n             'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n@@ -65,9 +67,9 @@\n \n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n-        $fileModel->surat = $request->surat;\n+        $fileModel->surat_id = $request->surat_id;\n         $fileModel->pegawai = $request->pegawai;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n@@ -85,9 +87,9 @@\n \n         $row = PengelolaanPersuratan::findOrFail($id);\n         return view('main.pengelolaan_persuratan.show', [\n             'title' => 'Detail Data Pengelolaan Persuratan',\n-            'surat' => $row->surat,\n+            'surat_id' => $row->surat_id,\n             'pegawai' => $row->pegawai,\n             'keterangan' => $row->keterangan,\n             'lampiran' => $row->lampiran,\n             'tanggal' => $row->tanggal,\n@@ -101,13 +103,14 @@\n     {\n \n         $row = PengelolaanPersuratan::findOrFail($id);\n         $user = User::all();\n+        $surat = Surat::all();\n         return view('main.pengelolaan_persuratan.edit', [\n             'title' => 'Edit Data Surat',\n             'user' => $user,\n             'id' => $row->id,\n-            'surat' => $row->surat,\n+            'surat' => $surat,\n             'pegawai' => $row->pegawai,\n             'keterangan' => $row->keterangan,\n             'tanggal' => $row->tanggal,\n             'status' => $row->status,\n@@ -123,9 +126,9 @@\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n-            'surat' => 'required',\n+            'surat_id' => 'required',\n             'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n@@ -137,9 +140,9 @@\n \n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n-        $fileModel->surat = $request->surat;\n+        $fileModel->surat_id = $request->surat_id;\n         $fileModel->pegawai = $request->pegawai;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705375168195,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -68,9 +68,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai = $request->pegawai;\n+        $fileModel->pegawai =  json_encode($request->pokja);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705375255033,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -68,9 +68,9 @@\n         $fileModel = new PengelolaanPersuratan();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai =  json_encode($request->pokja);\n+        $fileModel->pegawai =  json_encode($request->pegawai);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705386501875,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -141,9 +141,9 @@\n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai = $request->pegawai;\n+        $fileModel->pegawai =  json_encode($request->pegawai);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705386596843,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -141,9 +141,8 @@\n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai =  json_encode($request->pegawai);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705386609488,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,8 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'surat_id' => 'required',\n-            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n"
                },
                {
                    "date": 1705386640779,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,8 +127,9 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'surat_id' => 'required',\n+            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n@@ -140,8 +141,9 @@\n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n+        $fileModel->pegawai =  json_encode($request->pegawai);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705386793977,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,8 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'surat_id' => 'required',\n-            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n@@ -141,9 +140,8 @@\n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai =  json_encode($request->pegawai);\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705386818322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,8 +127,9 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'surat_id' => 'required',\n+            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n"
                },
                {
                    "date": 1705386845431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,8 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'surat_id' => 'required',\n-            'pegawai' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n"
                },
                {
                    "date": 1705388594079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,8 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n+        $fileModel->appreance = implode($request->pegawai);\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705388659359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,169 @@\n+<?php\n+\n+namespace App\\Http\\Controllers\\Main;\n+\n+use App\\Http\\Controllers\\Controller;\n+use App\\Models\\Surat;\n+use App\\Models\\PengelolaanPersuratan;\n+use App\\Models\\User;\n+use Illuminate\\Http\\Request;\n+use Illuminate\\Support\\Facades\\DB as FacadesDB;\n+\n+class PengelolaanPersuratanController extends Controller\n+{\n+    /**\n+     * Display a listing of the resource.\n+     */\n+    public function index()\n+    {\n+        if ($user = auth()->user()->jab_id == 4) {\n+            $user = auth()->user()->id;\n+            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n+            $user = PengelolaanPersuratan::with('users', 'surat')\n+                ->where('user_id', $user)\n+                ->get();\n+            $data['result'] = $user->sortDesc();\n+            return view('main.pengelolaan_persuratan.index', $data);\n+        } else {\n+            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n+            $user = PengelolaanPersuratan::with('users', 'surat')\n+                ->get();\n+            $data['result'] = $user->sortDesc();\n+            return view('main.pengelolaan_persuratan.index', $data);\n+        }\n+    }\n+\n+    /**\n+     * Show the form for creating a new resource.\n+     */\n+    public function create()\n+    {\n+        $data['user'] = User::all();\n+        $data['surat'] = Surat::all();\n+        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n+        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n+        return view(\"main.pengelolaan_persuratan.create\", $data);\n+    }\n+\n+    /**\n+     * Store a newly created resource in storage.\n+     */\n+    public function store(Request $request)\n+    {\n+        $request->validate([\n+            'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n+            'user_id' => 'required',\n+            'surat_id' => 'required',\n+            'pegawai' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n+            'status' => 'required',\n+        ]);\n+        // Proses pengunggahan berkas pertama\n+        $file1 = $request->file('file1');\n+        $file1Name = time() . '_' . $file1->getClientOriginalName();\n+        $file1->move(public_path('uploads'), $file1Name);\n+\n+\n+        $fileModel = new PengelolaanPersuratan();\n+\n+        $fileModel->user_id = $request->user_id;\n+        $fileModel->surat_id = $request->surat_id;\n+        $fileModel->pegawai =  json_encode($request->pegawai);\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->lampiran = $file1Name;\n+        $fileModel->tanggal = $request->tanggal;\n+        $fileModel->status = $request->status;\n+        $fileModel->pegawai = implode($request->pegawai);\n+\n+        $fileModel->save();\n+        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n+    }\n+\n+    /**\n+     * Display the specified resource.\n+     */\n+    public function show(string $id)\n+    {\n+\n+        $row = PengelolaanPersuratan::findOrFail($id);\n+        return view('main.pengelolaan_persuratan.show', [\n+            'title' => 'Detail Data Pengelolaan Persuratan',\n+            'surat_id' => $row->surat_id,\n+            'pegawai' => $row->pegawai,\n+            'keterangan' => $row->keterangan,\n+            'lampiran' => $row->lampiran,\n+            'tanggal' => $row->tanggal,\n+        ]);\n+    }\n+\n+    /**\n+     * Show the form for editing the specified resource.\n+     */\n+    public function edit(string $id)\n+    {\n+\n+        $row = PengelolaanPersuratan::findOrFail($id);\n+        $user = User::all();\n+        $surat = Surat::all();\n+        return view('main.pengelolaan_persuratan.edit', [\n+            'title' => 'Edit Data Surat',\n+            'user' => $user,\n+            'id' => $row->id,\n+            'surat' => $surat,\n+            'pegawai' => $row->pegawai,\n+            'keterangan' => $row->keterangan,\n+            'tanggal' => $row->tanggal,\n+            'status' => $row->status,\n+        ]);\n+    }\n+\n+    /**\n+     * Update the specified resource in storage.\n+     */\n+    public function update(Request $request, string $id)\n+    {\n+        $request->validate([\n+            // 'file1' => 'required|mimes:jpg,png|max:5048',\n+            // 'file2' => 'required|mimes:jpg,png|max:5048',\n+            // 'file3' => 'required|mimes:jpg,png|max:5048',\n+            'user_id' => 'required',\n+            'surat_id' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n+            'status' => 'required',\n+        ]);\n+        // // Proses pengunggahan berkas pertama\n+        // $file1 = $request->file('file1');\n+        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n+        // $file1->move(public_path('uploads'), $file1Name);\n+\n+\n+        $fileModel = PengelolaanPersuratan::find($id);\n+        $fileModel->user_id = $request->user_id;\n+        $fileModel->surat_id = $request->surat_id;\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->tanggal = $request->tanggal;\n+        $fileModel->status = $request->status;\n+\n+        $fileModel->save();\n+\n+        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n+    }\n+\n+    /**\n+     * Remove the specified resource from storage.\n+     */\n+    public function destroy(string $id)\n+    {\n+\n+        $data = PengelolaanPersuratan::findOrFail($id);\n+        $file_path = \"/uploads/\" . $data->lampiran;\n+\n+        if (file_exists($file_path)) {\n+            @unlink($file_path);\n+        }\n+        $data->delete();\n+        return back()->with('hapus', 'Data sudah di Hapus!');\n+    }\n+}\n"
                },
                {
                    "date": 1705388788342,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode($request->pegawai);\n+        $fileModel->pegawai = implode(\" \", $request->pegawai);\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n@@ -166,173 +166,4 @@\n         $data->delete();\n         return back()->with('hapus', 'Data sudah di Hapus!');\n     }\n }\n-<?php\n-\n-namespace App\\Http\\Controllers\\Main;\n-\n-use App\\Http\\Controllers\\Controller;\n-use App\\Models\\Surat;\n-use App\\Models\\PengelolaanPersuratan;\n-use App\\Models\\User;\n-use Illuminate\\Http\\Request;\n-use Illuminate\\Support\\Facades\\DB as FacadesDB;\n-\n-class PengelolaanPersuratanController extends Controller\n-{\n-    /**\n-     * Display a listing of the resource.\n-     */\n-    public function index()\n-    {\n-        if ($user = auth()->user()->jab_id == 4) {\n-            $user = auth()->user()->id;\n-            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users', 'surat')\n-                ->where('user_id', $user)\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pengelolaan_persuratan.index', $data);\n-        } else {\n-            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users', 'surat')\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pengelolaan_persuratan.index', $data);\n-        }\n-    }\n-\n-    /**\n-     * Show the form for creating a new resource.\n-     */\n-    public function create()\n-    {\n-        $data['user'] = User::all();\n-        $data['surat'] = Surat::all();\n-        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n-        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n-        return view(\"main.pengelolaan_persuratan.create\", $data);\n-    }\n-\n-    /**\n-     * Store a newly created resource in storage.\n-     */\n-    public function store(Request $request)\n-    {\n-        $request->validate([\n-            'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n-            'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // Proses pengunggahan berkas pertama\n-        $file1 = $request->file('file1');\n-        $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = new PengelolaanPersuratan();\n-\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai =  json_encode($request->pegawai);\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->lampiran = $file1Name;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-        $fileModel->appreance = implode($request->pegawai);\n-\n-        $fileModel->save();\n-        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n-    }\n-\n-    /**\n-     * Display the specified resource.\n-     */\n-    public function show(string $id)\n-    {\n-\n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        return view('main.pengelolaan_persuratan.show', [\n-            'title' => 'Detail Data Pengelolaan Persuratan',\n-            'surat_id' => $row->surat_id,\n-            'pegawai' => $row->pegawai,\n-            'keterangan' => $row->keterangan,\n-            'lampiran' => $row->lampiran,\n-            'tanggal' => $row->tanggal,\n-        ]);\n-    }\n-\n-    /**\n-     * Show the form for editing the specified resource.\n-     */\n-    public function edit(string $id)\n-    {\n-\n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        $user = User::all();\n-        $surat = Surat::all();\n-        return view('main.pengelolaan_persuratan.edit', [\n-            'title' => 'Edit Data Surat',\n-            'user' => $user,\n-            'id' => $row->id,\n-            'surat' => $surat,\n-            'pegawai' => $row->pegawai,\n-            'keterangan' => $row->keterangan,\n-            'tanggal' => $row->tanggal,\n-            'status' => $row->status,\n-        ]);\n-    }\n-\n-    /**\n-     * Update the specified resource in storage.\n-     */\n-    public function update(Request $request, string $id)\n-    {\n-        $request->validate([\n-            // 'file1' => 'required|mimes:jpg,png|max:5048',\n-            // 'file2' => 'required|mimes:jpg,png|max:5048',\n-            // 'file3' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // // Proses pengunggahan berkas pertama\n-        // $file1 = $request->file('file1');\n-        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        // $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = PengelolaanPersuratan::find($id);\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-\n-        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n-    }\n-\n-    /**\n-     * Remove the specified resource from storage.\n-     */\n-    public function destroy(string $id)\n-    {\n-\n-        $data = PengelolaanPersuratan::findOrFail($id);\n-        $file_path = \"/uploads/\" . $data->lampiran;\n-\n-        if (file_exists($file_path)) {\n-            @unlink($file_path);\n-        }\n-        $data->delete();\n-        return back()->with('hapus', 'Data sudah di Hapus!');\n-    }\n-}\n"
                },
                {
                    "date": 1705388864715,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode(\" \", $request->pegawai);\n+        $fileModel->pegawai = implode(\" \", $request->pegawai) . \"<br>\";\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705388932167,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode(\" \", $request->pegawai) . \"<br>\";\n+        $fileModel->pegawai = implode(\"<br>\", $request->pegawai);\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705389033863,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode(\"<br>\", $request->pegawai);\n+        $fileModel->pegawai = implode('column', $request->pegawai);\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705389278304,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode('column', $request->pegawai);\n+        $fileModel->pegawai = implode(\" \", $request->pegawai).\"<p>;\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705389345991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode(\" \", $request->pegawai).\"<p>;\n+        $fileModel->pegawai = implode(\" \", $request->pegawai).\"<br/>;\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705389392434,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->lampiran = $file1Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode(\" \", $request->pegawai).\"<br/>;\n+        $fileModel->pegawai = implode(\"+\", $request->pegawai);\n \n         $fileModel->save();\n         return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n"
                },
                {
                    "date": 1705451729661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,8 @@\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n-            'surat_id' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n@@ -140,9 +139,8 @@\n \n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705597014082,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -109,8 +109,9 @@\n         return view('main.pengelolaan_persuratan.edit', [\n             'title' => 'Edit Data Surat',\n             'user' => $user,\n             'id' => $row->id,\n+            'surat_id' => $row->surat_id,\n             'surat' => $surat,\n             'pegawai' => $row->pegawai,\n             'keterangan' => $row->keterangan,\n             'tanggal' => $row->tanggal,\n"
                },
                {
                    "date": 1705597257222,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,8 +128,9 @@\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n+            'surat_id' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n@@ -140,8 +141,9 @@\n \n \n         $fileModel = PengelolaanPersuratan::find($id);\n         $fileModel->user_id = $request->user_id;\n+        $fileModel->surat_id = $request->surat_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n"
                },
                {
                    "date": 1705597322616,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -140,9 +140,8 @@\n         // $file1->move(public_path('uploads'), $file1Name);\n \n \n         $fileModel = PengelolaanPersuratan::find($id);\n-        $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705597330469,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,8 @@\n         $request->validate([\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n             'surat_id' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n"
                },
                {
                    "date": 1705597387026,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,8 +127,9 @@\n         $request->validate([\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n+            'user_id' => 'required',\n             'surat_id' => 'required',\n             'keterangan' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n@@ -139,8 +140,9 @@\n         // $file1->move(public_path('uploads'), $file1Name);\n \n \n         $fileModel = PengelolaanPersuratan::find($id);\n+        $fileModel->user_id = $request->user_id;\n         $fileModel->surat_id = $request->surat_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705597418548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,8 +107,9 @@\n         $user = User::all();\n         $surat = Surat::all();\n         return view('main.pengelolaan_persuratan.edit', [\n             'title' => 'Edit Data Surat',\n+            'user_id' => $row->user_id,\n             'user' => $user,\n             'id' => $row->id,\n             'surat_id' => $row->surat_id,\n             'surat' => $surat,\n"
                },
                {
                    "date": 1705985800867,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,23 +15,12 @@\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        if ($user = auth()->user()->jab_id == 4) {\n-            $user = auth()->user()->id;\n-            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users', 'surat')\n-                ->where('user_id', $user)\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pengelolaan_persuratan.index', $data);\n-        } else {\n-            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n-            $user = PengelolaanPersuratan::with('users', 'surat')\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pengelolaan_persuratan.index', $data);\n-        }\n+        $data['title'] = 'Data pengajuan pengelolaan persuratan';\n+        $user = PengelolaanPersuratan::with('users', 'surat')->get();\n+        $data['result'] = $user->sortDesc();\n+        return view('main.pengelolaan_persuratan.index', $data);\n     }\n \n     /**\n      * Show the form for creating a new resource.\n"
                }
            ],
            "date": 1704864025101,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\Surat;\nuse App\\Models\\Pegawai;\nuse App\\Models\\PengelolaanPersuratan;\nuse App\\Models\\User;\nuse Illuminate\\Http\\Request;\n\nclass PengelolaanPersuratanController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        if ($user = auth()->user()->jab_id == 4) {\n            $user = auth()->user()->id;\n            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n            $user = PengelolaanPersuratan::with('users', 'surat', 'pegawai')\n                ->where('user_id', $user)\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pengelolaan_persuratan.index', $data);\n        } else {\n            $data['title'] = 'Data pengajuan pengelolaan persuratan';\n            $user = PengelolaanPersuratan::with('users', 'surat', 'pegawai')\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pengelolaan_persuratan.index', $data);\n        }\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['user'] = User::all();\n        $data['surat'] = Surat::all();\n        $data['pegawai'] = Pegawai::all();\n        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n        return view(\"main.pengelolaan_persuratan.create\", $data);\n    }\n\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n        $request->validate([\n            'file1' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'surat_id' => 'required',\n            'pegawai_id' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // Proses pengunggahan berkas pertama\n        $file1 = $request->file('file1');\n        $file1Name = time() . '_' . $file1->getClientOriginalName();\n        $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = new PengelolaanPersuratan();\n\n        $fileModel->user_id = $request->user_id;\n        $fileModel->surat_id = $request->surat_id;\n        $fileModel->pegawai_id = $request->pegawai_id;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->lampiran = $file1Name;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n    }\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n\n        $row = PengelolaanPersuratan::findOrFail($id);\n        return view('main.pengelolaan_persuratan.show', [\n            'title' => 'Detail Data Pengelolaan Persuratan',\n            'surat_id' => $row->surat_id,\n            'pegawai_id' => $row->pegawai_id,\n            'keterangan' => $row->keterangan,\n            'lampiran' => $row->lampiran,\n            'tanggal' => $row->tanggal,\n        ]);\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n\n        $row = PengelolaanPersuratan::findOrFail($id);\n        $user = User::all();\n        $surat = Surat::all();\n        $pegawai = Pegawai::all();\n        return view('main.pengelolaan_persuratan.edit', [\n            'title' => 'Edit Data Surat',\n            'user' => $user,\n            'id' => $row->id,\n            'surat' => $surat,\n            'pegawai' => $pegawai,\n            'keterangan' => $row->keterangan,\n            'tanggal' => $row->tanggal,\n            'status' => $row->status,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n        $request->validate([\n            // 'file1' => 'required|mimes:jpg,png|max:5048',\n            // 'file2' => 'required|mimes:jpg,png|max:5048',\n            // 'file3' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'surat_id' => 'required',\n            'pegawai_id' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // // Proses pengunggahan berkas pertama\n        // $file1 = $request->file('file1');\n        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n        // $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = PengelolaanPersuratan::find($id);\n        $fileModel->user_id = $request->user_id;\n        $fileModel->surat_id = $request->surat_id;\n        $fileModel->pegawai_id = $request->pegawai_id;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n\n        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n    }\n\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n\n        $data = PengelolaanPersuratan::findOrFail($id);\n        $image_path = \"/uploads/\" . $data->lampiran;\n\n        if (file_exists($image_path)) {\n            @unlink($image_path);\n        }\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n}\n"
        }
    ]
}