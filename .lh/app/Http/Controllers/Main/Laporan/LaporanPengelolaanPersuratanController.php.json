{
    "sourceFile": "app/Http/Controllers/Main/Laporan/LaporanPengelolaanPersuratanController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 8,
            "patches": [
                {
                    "date": 1704865007492,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1704867301233,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,10 +16,10 @@\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        $data['title'] = 'Laporan Peminjaman Ruang';\n-        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'ruang')->get();\n+        $data['title'] = 'Laporan Pengelolaan Persuratan';\n+        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'surat', 'pegawai')->get();\n         $data['result'] = $pengelolaan_persuratan->sortDesc();\n         return view('main.pengelolaan_persuratan.index', $data);\n     }\n \n"
                },
                {
                    "date": 1704867419684,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,18 +74,9 @@\n      * Display the specified resource.\n      */\n     public function show(string $id)\n     {\n-\n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        return view('main.pengelolaan_persuratan.show', [\n-            'title' => 'Detail Data Pengelolaan Persuratan',\n-            'surat_id' => $row->surat_id,\n-            'pegawai_id' => $row->pegawai_id,\n-            'keterangan' => $row->keterangan,\n-            'lampiran' => $row->lampiran,\n-            'tanggal' => $row->tanggal,\n-        ]);\n+        //\n     }\n     /**\n      * Show the form for editing the specified resource.\n      */\n@@ -139,9 +130,9 @@\n         $fileModel->status = $request->status;\n \n         $fileModel->save();\n \n-        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n+        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n     }\n \n \n     /**\n"
                },
                {
                    "date": 1704867440511,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,9 +66,9 @@\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n         $fileModel->save();\n-        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n+        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n     }\n \n     /**\n      * Display the specified resource.\n"
                },
                {
                    "date": 1704867515433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,177 @@\n+<?php\n+\n+namespace App\\Http\\Controllers\\Main\\Laporan;\n+\n+use App\\Http\\Controllers\\Controller;\n+use App\\Models\\Surat;\n+use App\\Models\\Pegawai;\n+use App\\Models\\PengelolaanPersuratan;\n+use App\\Models\\User;\n+use Illuminate\\Http\\Request;\n+use Illuminate\\Support\\Facades\\DB as FacadesDB;\n+\n+class LaporanPengelolaanPersuratanController extends Controller\n+{\n+    /**\n+     * Display a listing of the resource.\n+     */\n+    public function index()\n+    {\n+        $data['title'] = 'Laporan Pengelolaan Persuratan';\n+        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'surat', 'pegawai')->get();\n+        $data['result'] = $pengelolaan_persuratan->sortDesc();\n+        return view('main.pengelolaan_persuratan.index', $data);\n+    }\n+\n+    /**\n+     * Show the form for creating a new resource.\n+     */\n+    public function create()\n+    {\n+        $data['user'] = User::all();\n+        $data['pegawai'] = Pegawai::all();\n+        $data['surat'] = Surat::all();\n+        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n+        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n+        return view(\"main.pengelolaan_persuratan.create\", $data);\n+    }\n+\n+    /**\n+     * Store a newly created resource in storage.\n+     */\n+    public function store(Request $request)\n+    {\n+        $request->validate([\n+            'file1' => 'required|mimes:jpg,png|max:5048',\n+            'user_id' => 'required',\n+            'surat_id' => 'required',\n+            'pegawai_id' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n+            'status' => 'required',\n+        ]);\n+        // Proses pengunggahan berkas pertama\n+        $file1 = $request->file('file1');\n+        $file1Name = time() . '_' . $file1->getClientOriginalName();\n+        $file1->move(public_path('uploads'), $file1Name);\n+\n+\n+        $fileModel = new PengelolaanPersuratan();\n+\n+        $fileModel->user_id = $request->user_id;\n+        $fileModel->surat_id = $request->surat_id;\n+        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->lampiran = $file1Name;\n+        $fileModel->tanggal = $request->tanggal;\n+        $fileModel->status = $request->status;\n+\n+        $fileModel->save();\n+        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n+    }\n+\n+    /**\n+     * Display the specified resource.\n+     */\n+    public function show(string $id)\n+    {\n+        //\n+    }\n+    /**\n+     * Show the form for editing the specified resource.\n+     */\n+    public function edit(string $id)\n+    {\n+\n+        $row = PengelolaanPersuratan::findOrFail($id);\n+        $user = User::all();\n+        $surat = Surat::all();\n+        $pegawai = Pegawai::all();\n+        return view('main.pengelolaan_persuratan.edit', [\n+            'title' => 'Edit Data Surat',\n+            'user' => $user,\n+            'id' => $row->id,\n+            'surat' => $surat,\n+            'pegawai' => $pegawai,\n+            'keterangan' => $row->keterangan,\n+            'tanggal' => $row->tanggal,\n+            'status' => $row->status,\n+        ]);\n+    }\n+\n+    /**\n+     * Update the specified resource in storage.\n+     */\n+    public function update(Request $request, string $id)\n+    {\n+        $request->validate([\n+            // 'file1' => 'required|mimes:jpg,png|max:5048',\n+            // 'file2' => 'required|mimes:jpg,png|max:5048',\n+            // 'file3' => 'required|mimes:jpg,png|max:5048',\n+            'user_id' => 'required',\n+            'surat_id' => 'required',\n+            'pegawai_id' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n+            'status' => 'required',\n+        ]);\n+        // // Proses pengunggahan berkas pertama\n+        // $file1 = $request->file('file1');\n+        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n+        // $file1->move(public_path('uploads'), $file1Name);\n+\n+\n+        $fileModel = PengelolaanPersuratan::find($id);\n+        $fileModel->user_id = $request->user_id;\n+        $fileModel->surat_id = $request->surat_id;\n+        $fileModel->pegawai_id = $request->pegawai_id;\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->tanggal = $request->tanggal;\n+        $fileModel->status = $request->status;\n+\n+        $fileModel->save();\n+\n+        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n+    }\n+\n+\n+    /**\n+     * Remove the specified resource from storage.\n+     */\n+    public function destroy(string $id)\n+    {\n+\n+        $data = PengelolaanPersuratan::findOrFail($id);\n+        $image_path = \"/uploads/\" . $data->lampiran;\n+\n+        if (file_exists($image_path)) {\n+            @unlink($image_path);\n+        }\n+        $data->delete();\n+        return back()->with('hapus', 'Data sudah di Hapus!');\n+    }\n+    public function print(Request $request)\n+    {\n+        $validasi = $this->validate(\n+            $request,\n+            [\n+                'tgl_a' => 'required',\n+                'tgl_b' => 'required',\n+            ],\n+            [\n+                'tgl_a.required' => 'tanggal tidak boleh kosong',\n+                'tgl_b.required' => 'tanggal tidak boleh kosong',\n+            ]\n+        );\n+        $tgl_a = $request->tgl_a;\n+        $tgl_b = $request->tgl_b;\n+\n+        $row = PengelolaanPersuratan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n+        return view('main.pengelolaan_persuratan.print', [\n+            'title' => 'Laporan Data Pengelolaan persuratan',\n+            'result' => $row,\n+            'tgl_a' => $tgl_a,\n+            'tgl_b' => $tgl_b,\n+        ]);\n+    }\n+}\n"
                },
                {
                    "date": 1704868289926,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -167,188 +167,11 @@\n         $tgl_b = $request->tgl_b;\n \n         $row = PengelolaanPersuratan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n         return view('main.pengelolaan_persuratan.print', [\n-            'title' => 'Laporan Data Pengelolaan persuratan',\n+            'title' => 'Laporan Data Pengelolaan Persuratan',\n             'result' => $row,\n             'tgl_a' => $tgl_a,\n             'tgl_b' => $tgl_b,\n         ]);\n     }\n }\n-<?php\n-\n-namespace App\\Http\\Controllers\\Main\\Laporan;\n-\n-use App\\Http\\Controllers\\Controller;\n-use App\\Models\\Surat;\n-use App\\Models\\Pegawai;\n-use App\\Models\\PengelolaanPersuratan;\n-use App\\Models\\User;\n-use Illuminate\\Http\\Request;\n-use Illuminate\\Support\\Facades\\DB as FacadesDB;\n-\n-class LaporanPengelolaanPersuratanController extends Controller\n-{\n-    /**\n-     * Display a listing of the resource.\n-     */\n-    public function index()\n-    {\n-        $data['title'] = 'Laporan Pengelolaan Persuratan';\n-        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'surat', 'pegawai')->get();\n-        $data['result'] = $pengelolaan_persuratan->sortDesc();\n-        return view('main.pengelolaan_persuratan.index', $data);\n-    }\n-\n-    /**\n-     * Show the form for creating a new resource.\n-     */\n-    public function create()\n-    {\n-        $data['user'] = User::all();\n-        $data['pegawai'] = Pegawai::all();\n-        $data['surat'] = Surat::all();\n-        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n-        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n-        return view(\"main.pengelolaan_persuratan.create\", $data);\n-    }\n-\n-    /**\n-     * Store a newly created resource in storage.\n-     */\n-    public function store(Request $request)\n-    {\n-        $request->validate([\n-            'file1' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai_id' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // Proses pengunggahan berkas pertama\n-        $file1 = $request->file('file1');\n-        $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = new PengelolaanPersuratan();\n-\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->lampiran = $file1Name;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n-    }\n-\n-    /**\n-     * Display the specified resource.\n-     */\n-    public function show(string $id)\n-    {\n-        //\n-    }\n-    /**\n-     * Show the form for editing the specified resource.\n-     */\n-    public function edit(string $id)\n-    {\n-\n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        $user = User::all();\n-        $surat = Surat::all();\n-        $pegawai = Pegawai::all();\n-        return view('main.pengelolaan_persuratan.edit', [\n-            'title' => 'Edit Data Surat',\n-            'user' => $user,\n-            'id' => $row->id,\n-            'surat' => $surat,\n-            'pegawai' => $pegawai,\n-            'keterangan' => $row->keterangan,\n-            'tanggal' => $row->tanggal,\n-            'status' => $row->status,\n-        ]);\n-    }\n-\n-    /**\n-     * Update the specified resource in storage.\n-     */\n-    public function update(Request $request, string $id)\n-    {\n-        $request->validate([\n-            // 'file1' => 'required|mimes:jpg,png|max:5048',\n-            // 'file2' => 'required|mimes:jpg,png|max:5048',\n-            // 'file3' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai_id' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // // Proses pengunggahan berkas pertama\n-        // $file1 = $request->file('file1');\n-        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        // $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = PengelolaanPersuratan::find($id);\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-\n-        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n-    }\n-\n-\n-    /**\n-     * Remove the specified resource from storage.\n-     */\n-    public function destroy(string $id)\n-    {\n-\n-        $data = PengelolaanPersuratan::findOrFail($id);\n-        $image_path = \"/uploads/\" . $data->lampiran;\n-\n-        if (file_exists($image_path)) {\n-            @unlink($image_path);\n-        }\n-        $data->delete();\n-        return back()->with('hapus', 'Data sudah di Hapus!');\n-    }\n-    public function print(Request $request)\n-    {\n-        $validasi = $this->validate(\n-            $request,\n-            [\n-                'tgl_a' => 'required',\n-                'tgl_b' => 'required',\n-            ],\n-            [\n-                'tgl_a.required' => 'tanggal tidak boleh kosong',\n-                'tgl_b.required' => 'tanggal tidak boleh kosong',\n-            ]\n-        );\n-        $tgl_a = $request->tgl_a;\n-        $tgl_b = $request->tgl_b;\n-\n-        $row = PengelolaanPersuratan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n-        return view('main.pengelolaan_persuratan.print', [\n-            'title' => 'Laporan Data Pengelolaan persuratan',\n-            'result' => $row,\n-            'tgl_a' => $tgl_a,\n-            'tgl_b' => $tgl_b,\n-        ]);\n-    }\n-}\n"
                },
                {
                    "date": 1704869314829,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,26 +74,32 @@\n      * Display the specified resource.\n      */\n     public function show(string $id)\n     {\n-        //\n+        $row = PengelolaanPersuratan::findOrFail($id);\n+        return view('main.pengelolaan_persuratan.show', [\n+            'title' => 'Detail Data Pengelolaan Persuratan',\n+            'keterangan' => $row->keterangan,\n+            'lampiran' => $row->lampiran,\n+            'tanggal' => $row->tanggal,\n+        ]);\n     }\n     /**\n      * Show the form for editing the specified resource.\n      */\n     public function edit(string $id)\n     {\n \n         $row = PengelolaanPersuratan::findOrFail($id);\n-        $user = User::all();\n-        $surat = Surat::all();\n-        $pegawai = Pegawai::all();\n         return view('main.pengelolaan_persuratan.edit', [\n             'title' => 'Edit Data Surat',\n-            'user' => $user,\n             'id' => $row->id,\n-            'surat' => $surat,\n-            'pegawai' => $pegawai,\n+            'user_id' => $row->user_id,\n+            'surat_id' => $row->surat_id,\n+            'pegawai_id' => $row->pegawai_id,\n+            'user' => User::all(),\n+            'surat' => Surat::all(),\n+            'pegawai' => Pegawai::all(),\n             'keterangan' => $row->keterangan,\n             'tanggal' => $row->tanggal,\n             'status' => $row->status,\n         ]);\n"
                },
                {
                    "date": 1705110486487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,144 +19,50 @@\n     {\n         $data['title'] = 'Laporan Pengelolaan Persuratan';\n         $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'surat', 'pegawai')->get();\n         $data['result'] = $pengelolaan_persuratan->sortDesc();\n-        return view('main.pengelolaan_persuratan.index', $data);\n+        return view('main.pengelolaan_persuratan.laporan', $data);\n     }\n \n     /**\n      * Show the form for creating a new resource.\n      */\n     public function create()\n     {\n-        $data['user'] = User::all();\n-        $data['pegawai'] = Pegawai::all();\n-        $data['surat'] = Surat::all();\n-        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n-        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n-        return view(\"main.pengelolaan_persuratan.create\", $data);\n+        //\n     }\n \n     /**\n      * Store a newly created resource in storage.\n      */\n     public function store(Request $request)\n     {\n-        $request->validate([\n-            'file1' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai_id' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // Proses pengunggahan berkas pertama\n-        $file1 = $request->file('file1');\n-        $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = new PengelolaanPersuratan();\n-\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->lampiran = $file1Name;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n+        //\n     }\n \n     /**\n      * Display the specified resource.\n      */\n     public function show(string $id)\n     {\n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        return view('main.pengelolaan_persuratan.show', [\n-            'title' => 'Detail Data Pengelolaan Persuratan',\n-            'keterangan' => $row->keterangan,\n-            'lampiran' => $row->lampiran,\n-            'tanggal' => $row->tanggal,\n-        ]);\n+        //\n     }\n     /**\n      * Show the form for editing the specified resource.\n      */\n     public function edit(string $id)\n     {\n \n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        return view('main.pengelolaan_persuratan.edit', [\n-            'title' => 'Edit Data Surat',\n-            'id' => $row->id,\n-            'user_id' => $row->user_id,\n-            'surat_id' => $row->surat_id,\n-            'pegawai_id' => $row->pegawai_id,\n-            'user' => User::all(),\n-            'surat' => Surat::all(),\n-            'pegawai' => Pegawai::all(),\n-            'keterangan' => $row->keterangan,\n-            'tanggal' => $row->tanggal,\n-            'status' => $row->status,\n-        ]);\n+        //\n     }\n \n     /**\n      * Update the specified resource in storage.\n      */\n     public function update(Request $request, string $id)\n     {\n-        $request->validate([\n-            // 'file1' => 'required|mimes:jpg,png|max:5048',\n-            // 'file2' => 'required|mimes:jpg,png|max:5048',\n-            // 'file3' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai_id' => 'required',\n-            'keterangan' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // // Proses pengunggahan berkas pertama\n-        // $file1 = $request->file('file1');\n-        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        // $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = PengelolaanPersuratan::find($id);\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai_id = $request->pegawai_id;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-\n-        return redirect('main/laporan/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n+        //\n     }\n-\n-\n-    /**\n-     * Remove the specified resource from storage.\n-     */\n-    public function destroy(string $id)\n-    {\n-\n-        $data = PengelolaanPersuratan::findOrFail($id);\n-        $image_path = \"/uploads/\" . $data->lampiran;\n-\n-        if (file_exists($image_path)) {\n-            @unlink($image_path);\n-        }\n-        $data->delete();\n-        return back()->with('hapus', 'Data sudah di Hapus!');\n-    }\n     public function print(Request $request)\n     {\n         $validasi = $this->validate(\n             $request,\n@@ -179,5 +85,15 @@\n             'tgl_a' => $tgl_a,\n             'tgl_b' => $tgl_b,\n         ]);\n     }\n+\n+\n+    /**\n+     * Remove the specified resource from storage.\n+     */\n+    public function destroy(string $id)\n+    {\n+\n+        //\n+    }\n }\n"
                },
                {
                    "date": 1705395250710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n      */\n     public function index()\n     {\n         $data['title'] = 'Laporan Pengelolaan Persuratan';\n-        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'surat', 'pegawai')->get();\n+        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'surat')->get();\n         $data['result'] = $pengelolaan_persuratan->sortDesc();\n         return view('main.pengelolaan_persuratan.laporan', $data);\n     }\n \n"
                }
            ],
            "date": 1704865007492,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main\\Laporan;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\Surat;\nuse App\\Models\\Pegawai;\nuse App\\Models\\PengelolaanPersuratan;\nuse App\\Models\\User;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\DB as FacadesDB;\n\nclass LaporanPengelolaanPersuratanController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        $data['title'] = 'Laporan Peminjaman Ruang';\n        $pengelolaan_persuratan = PengelolaanPersuratan::with('users', 'ruang')->get();\n        $data['result'] = $pengelolaan_persuratan->sortDesc();\n        return view('main.pengelolaan_persuratan.index', $data);\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['user'] = User::all();\n        $data['pegawai'] = Pegawai::all();\n        $data['surat'] = Surat::all();\n        $data['pengelolaan_persuratan'] = PengelolaanPersuratan::all();\n        $data['title'] = \"Tambah Data Pengelolaan Persuratan\";\n        return view(\"main.pengelolaan_persuratan.create\", $data);\n    }\n\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n        $request->validate([\n            'file1' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'surat_id' => 'required',\n            'pegawai_id' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // Proses pengunggahan berkas pertama\n        $file1 = $request->file('file1');\n        $file1Name = time() . '_' . $file1->getClientOriginalName();\n        $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = new PengelolaanPersuratan();\n\n        $fileModel->user_id = $request->user_id;\n        $fileModel->surat_id = $request->surat_id;\n        $fileModel->pegawai_id = $request->pegawai_id;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->lampiran = $file1Name;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n    }\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n\n        $row = PengelolaanPersuratan::findOrFail($id);\n        return view('main.pengelolaan_persuratan.show', [\n            'title' => 'Detail Data Pengelolaan Persuratan',\n            'surat_id' => $row->surat_id,\n            'pegawai_id' => $row->pegawai_id,\n            'keterangan' => $row->keterangan,\n            'lampiran' => $row->lampiran,\n            'tanggal' => $row->tanggal,\n        ]);\n    }\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n\n        $row = PengelolaanPersuratan::findOrFail($id);\n        $user = User::all();\n        $surat = Surat::all();\n        $pegawai = Pegawai::all();\n        return view('main.pengelolaan_persuratan.edit', [\n            'title' => 'Edit Data Surat',\n            'user' => $user,\n            'id' => $row->id,\n            'surat' => $surat,\n            'pegawai' => $pegawai,\n            'keterangan' => $row->keterangan,\n            'tanggal' => $row->tanggal,\n            'status' => $row->status,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n        $request->validate([\n            // 'file1' => 'required|mimes:jpg,png|max:5048',\n            // 'file2' => 'required|mimes:jpg,png|max:5048',\n            // 'file3' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'surat_id' => 'required',\n            'pegawai_id' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // // Proses pengunggahan berkas pertama\n        // $file1 = $request->file('file1');\n        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n        // $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = PengelolaanPersuratan::find($id);\n        $fileModel->user_id = $request->user_id;\n        $fileModel->surat_id = $request->surat_id;\n        $fileModel->pegawai_id = $request->pegawai_id;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n\n        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n    }\n\n\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n\n        $data = PengelolaanPersuratan::findOrFail($id);\n        $image_path = \"/uploads/\" . $data->lampiran;\n\n        if (file_exists($image_path)) {\n            @unlink($image_path);\n        }\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n    public function print(Request $request)\n    {\n        $validasi = $this->validate(\n            $request,\n            [\n                'tgl_a' => 'required',\n                'tgl_b' => 'required',\n            ],\n            [\n                'tgl_a.required' => 'tanggal tidak boleh kosong',\n                'tgl_b.required' => 'tanggal tidak boleh kosong',\n            ]\n        );\n        $tgl_a = $request->tgl_a;\n        $tgl_b = $request->tgl_b;\n\n        $row = PengelolaanPersuratan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n        return view('main.pengelolaan_persuratan.print', [\n            'title' => 'Laporan Data Pengelolaan persuratan',\n            'result' => $row,\n            'tgl_a' => $tgl_a,\n            'tgl_b' => $tgl_b,\n        ]);\n    }\n}\n"
        }
    ]
}