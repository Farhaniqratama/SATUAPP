{
    "sourceFile": "app/Http/Controllers/Main/Laporan/LaporanPeminjamanKendaraanController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1704972833932,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1704972845865,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -171,9 +171,9 @@\n         $tgl_b = $request->tgl_b;\n \n         $row = PeminjamanKendaraan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n         return view('main.peminjaman_kendaraan.print', [\n-            'title' => 'Laporan Data Peminjaman Ruang',\n+            'title' => 'Laporan Data Peminjaman Kendaraan',\n             'result' => $row,\n             'tgl_a' => $tgl_a,\n             'tgl_b' => $tgl_b,\n         ]);\n"
                },
                {
                    "date": 1704975144065,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n     {\n         $data['title'] = 'Laporan Peminjaman Kendaraan';\n         $peminjaman_kendaraan = PeminjamanKendaraan::with('users', 'kendaraan')->get();\n         $data['result'] = $peminjaman_kendaraan->sortDesc();\n-        return view('main.peminjaman_kendaraan.index', $data);\n+        return view('main.peminjaman_kendaraan.laporan', $data);\n     }\n \n     /**\n      * Show the form for creating a new resource.\n"
                },
                {
                    "date": 1704975363526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,61 +26,14 @@\n      * Show the form for creating a new resource.\n      */\n     public function create()\n     {\n-        $data['user'] = User::all();\n-        $data['kendaraan'] = Kendaraan::where('status', 1)->get();\n-        $data['peminjaman_kendaraan'] = PeminjamanKendaraan::all();\n-        $data['title'] = \"Tambah Data Peminjaman Kendaraan\";\n-        return view(\"main.peminjaman_kendaraan.create\", $data);\n     }\n     /**\n      * Store a newly created resource in storage.\n      */\n     public function store(Request $request)\n     {\n-        $validasi = $this->validate(\n-            $request,\n-            [\n-                'user_id' => 'required',\n-                'kendaraan_id' => 'required',\n-                'kegiatan' => 'required',\n-                'tanggal_pinjam' => 'required',\n-                'jam_pinjam' => 'required',\n-                'tanggal_kembali' => 'required',\n-                'jam_kembali' => 'required',\n-                'keterangan' => 'required',\n-                'status' => 'required',\n-\n-            ],\n-            [\n-                'user_id.required' => 'user_id produk tidak boleh kosong',\n-                'kendaraan_id.required' => 'kendaraan_id tidak boleh kosong',\n-                'kegiatan.required' => 'kegiatan tidak boleh kosong',\n-                'tanggal_pinjam.required' => 'tanggal_pinjam tidak boleh kosong',\n-                'jam_pinjam.required' => 'jam_pinjam tidak boleh kosong',\n-                'tanggal_kembali.required' => 'tanggal_kembali tidak boleh kosong',\n-                'jam_kembali.required' => 'jam_kembali tidak boleh kosong',\n-                'keterangan.required' => 'keterangan tidak boleh kosong',\n-                'status.required' => 'status tidak boleh kosong',\n-            ]\n-        );\n-\n-        PeminjamanKendaraan::create([\n-            'user_id' => $request->user_id,\n-            'kendaraan_id' => $request->kendaraan_id,\n-            'kegiatan' => $request->kegiatan,\n-            'tanggal_pinjam' => $request->tanggal_pinjam,\n-            'jam_pinjam' => $request->jam_pinjam,\n-            'tanggal_kembali' => $request->tanggal_kembali,\n-            'jam_kembali' => $request->jam_kembali,\n-            'keterangan' => $request->keterangan,\n-            'status' => $request->status,\n-        ]);\n-\n-        Kendaraan::where('id', $request->kendaraan_id)->update(['status' => 0]);\n-\n-        return redirect('main/peminjaman_kendaraan')->with('success', 'Data berhasil disimpan!');\n     }\n \n \n     /**\n@@ -95,66 +48,16 @@\n      * Show the form for editing the specified resource.\n      */\n     public function edit(string $id)\n     {\n-        $row = PeminjamanKendaraan::findOrFail($id);\n-        $user = User::all();\n-        $kendaraan = Kendaraan::all();\n-        return view('main.peminjaman_kendaraan.edit', [\n-            'title' => 'Edit Data Pengajuan Peminjaman Kendaraan',\n-            'user' => $user,\n-            'id' => $row->id,\n-            'nama' => $row->nama,\n-            'kendaraan' => $kendaraan,\n-            'kegiatan' => $row->kegiatan,\n-            'tanggal_pinjam' => $row->tanggal_pinjam,\n-            'jam_pinjam' => $row->jam_pinjam,\n-            'tanggal_kembali' => $row->tanggal_kembali,\n-            'jam_kembali' => $row->jam_kembali,\n-            'keterangan' => $row->keterangan,\n-            'status' => $row->status,\n-        ]);\n     }\n \n     /**\n      * Update the specified resource in storage.\n      */\n     public function update(Request $request, string $id)\n     {\n-\n-        $row = PeminjamanKendaraan::find($id);\n-        if ($row) {\n-            if ($row->kendaraan_id != $request->kendaraan_id) {\n-                Kendaraan::where('id', $row->kendaraan_id)->update(['status' => 1]);\n-                Kendaraan::where('id', $request->kendaraan_id)->update(['status' => 0]);\n-            }\n-            $row->user_id = $request->user_id;\n-            $row->kendaraan_id = $request->kendaraan_id;\n-            $row->kegiatan = $request->kegiatan;\n-            $row->tanggal_pinjam = $request->tanggal_pinjam;\n-            $row->jam_pinjam = $request->jam_pinjam;\n-            $row->tanggal_kembali = $request->tanggal_kembali;\n-            $row->jam_kembali = $request->jam_kembali;\n-            $row->keterangan = $request->keterangan;\n-            $row->status = $request->status;\n-\n-            $row->save();\n-            if ($row->status != 'pending') {\n-                Kendaraan::where('id', $request->kendaraan_id)->update(['status' => 1]);\n-            }\n-            return redirect('main/peminjaman_kendaraan')->with('success', 'Data berhasil diubah');\n-        }\n     }\n-    /**\n-     * Remove the specified resource from storage.\n-     */\n-    public function destroy(string $id)\n-    {\n-        $data = PeminjamanKendaraan::findOrFail($id);\n-        Kendaraan::where('id', $data->kendaraan_id)->update(['status' => 1]);\n-        $data->delete();\n-        return back()->with('hapus', 'Data sudah di Hapus!');\n-    }\n     public function print(Request $request)\n     {\n         $validasi = $this->validate(\n             $request,\n@@ -177,5 +80,11 @@\n             'tgl_a' => $tgl_a,\n             'tgl_b' => $tgl_b,\n         ]);\n     }\n+    /**\n+     * Remove the specified resource from storage.\n+     */\n+    public function destroy(string $id)\n+    {\n+    }\n }\n"
                },
                {
                    "date": 1705025033674,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        $data['title'] = 'Laporan Peminjaman Kendaraan';\n+        $data['title'] = 'Laporan Pengajuan Kendaraan';\n         $peminjaman_kendaraan = PeminjamanKendaraan::with('users', 'kendaraan')->get();\n         $data['result'] = $peminjaman_kendaraan->sortDesc();\n         return view('main.peminjaman_kendaraan.laporan', $data);\n     }\n@@ -74,9 +74,9 @@\n         $tgl_b = $request->tgl_b;\n \n         $row = PeminjamanKendaraan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n         return view('main.peminjaman_kendaraan.print', [\n-            'title' => 'Laporan Data Peminjaman Kendaraan',\n+            'title' => 'Laporan Data Pengajuan Kendaraan',\n             'result' => $row,\n             'tgl_a' => $tgl_a,\n             'tgl_b' => $tgl_b,\n         ]);\n"
                }
            ],
            "date": 1704972833932,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main\\Laporan;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\PeminjamanKendaraan;\nuse App\\Models\\User;\nuse App\\Models\\Kendaraan;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\DB as FacadesDB;\n\nclass LaporanPeminjamanKendaraanController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        $data['title'] = 'Laporan Peminjaman Kendaraan';\n        $peminjaman_kendaraan = PeminjamanKendaraan::with('users', 'kendaraan')->get();\n        $data['result'] = $peminjaman_kendaraan->sortDesc();\n        return view('main.peminjaman_kendaraan.index', $data);\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['user'] = User::all();\n        $data['kendaraan'] = Kendaraan::where('status', 1)->get();\n        $data['peminjaman_kendaraan'] = PeminjamanKendaraan::all();\n        $data['title'] = \"Tambah Data Peminjaman Kendaraan\";\n        return view(\"main.peminjaman_kendaraan.create\", $data);\n    }\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n        $validasi = $this->validate(\n            $request,\n            [\n                'user_id' => 'required',\n                'kendaraan_id' => 'required',\n                'kegiatan' => 'required',\n                'tanggal_pinjam' => 'required',\n                'jam_pinjam' => 'required',\n                'tanggal_kembali' => 'required',\n                'jam_kembali' => 'required',\n                'keterangan' => 'required',\n                'status' => 'required',\n\n            ],\n            [\n                'user_id.required' => 'user_id produk tidak boleh kosong',\n                'kendaraan_id.required' => 'kendaraan_id tidak boleh kosong',\n                'kegiatan.required' => 'kegiatan tidak boleh kosong',\n                'tanggal_pinjam.required' => 'tanggal_pinjam tidak boleh kosong',\n                'jam_pinjam.required' => 'jam_pinjam tidak boleh kosong',\n                'tanggal_kembali.required' => 'tanggal_kembali tidak boleh kosong',\n                'jam_kembali.required' => 'jam_kembali tidak boleh kosong',\n                'keterangan.required' => 'keterangan tidak boleh kosong',\n                'status.required' => 'status tidak boleh kosong',\n            ]\n        );\n\n        PeminjamanKendaraan::create([\n            'user_id' => $request->user_id,\n            'kendaraan_id' => $request->kendaraan_id,\n            'kegiatan' => $request->kegiatan,\n            'tanggal_pinjam' => $request->tanggal_pinjam,\n            'jam_pinjam' => $request->jam_pinjam,\n            'tanggal_kembali' => $request->tanggal_kembali,\n            'jam_kembali' => $request->jam_kembali,\n            'keterangan' => $request->keterangan,\n            'status' => $request->status,\n        ]);\n\n        Kendaraan::where('id', $request->kendaraan_id)->update(['status' => 0]);\n\n        return redirect('main/peminjaman_kendaraan')->with('success', 'Data berhasil disimpan!');\n    }\n\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n        //\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n        $row = PeminjamanKendaraan::findOrFail($id);\n        $user = User::all();\n        $kendaraan = Kendaraan::all();\n        return view('main.peminjaman_kendaraan.edit', [\n            'title' => 'Edit Data Pengajuan Peminjaman Kendaraan',\n            'user' => $user,\n            'id' => $row->id,\n            'nama' => $row->nama,\n            'kendaraan' => $kendaraan,\n            'kegiatan' => $row->kegiatan,\n            'tanggal_pinjam' => $row->tanggal_pinjam,\n            'jam_pinjam' => $row->jam_pinjam,\n            'tanggal_kembali' => $row->tanggal_kembali,\n            'jam_kembali' => $row->jam_kembali,\n            'keterangan' => $row->keterangan,\n            'status' => $row->status,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n\n        $row = PeminjamanKendaraan::find($id);\n        if ($row) {\n            if ($row->kendaraan_id != $request->kendaraan_id) {\n                Kendaraan::where('id', $row->kendaraan_id)->update(['status' => 1]);\n                Kendaraan::where('id', $request->kendaraan_id)->update(['status' => 0]);\n            }\n            $row->user_id = $request->user_id;\n            $row->kendaraan_id = $request->kendaraan_id;\n            $row->kegiatan = $request->kegiatan;\n            $row->tanggal_pinjam = $request->tanggal_pinjam;\n            $row->jam_pinjam = $request->jam_pinjam;\n            $row->tanggal_kembali = $request->tanggal_kembali;\n            $row->jam_kembali = $request->jam_kembali;\n            $row->keterangan = $request->keterangan;\n            $row->status = $request->status;\n\n            $row->save();\n            if ($row->status != 'pending') {\n                Kendaraan::where('id', $request->kendaraan_id)->update(['status' => 1]);\n            }\n            return redirect('main/peminjaman_kendaraan')->with('success', 'Data berhasil diubah');\n        }\n    }\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n        $data = PeminjamanKendaraan::findOrFail($id);\n        Kendaraan::where('id', $data->kendaraan_id)->update(['status' => 1]);\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n    public function print(Request $request)\n    {\n        $validasi = $this->validate(\n            $request,\n            [\n                'tgl_a' => 'required',\n                'tgl_b' => 'required',\n            ],\n            [\n                'tgl_a.required' => 'tanggal tidak boleh kosong',\n                'tgl_b.required' => 'tanggal tidak boleh kosong',\n            ]\n        );\n        $tgl_a = $request->tgl_a;\n        $tgl_b = $request->tgl_b;\n\n        $row = PeminjamanKendaraan::whereBetween(FacadesDB::raw(\"DATE_FORMAT(created_at,'%Y-%m-%d')\"), [$tgl_a, $tgl_b])->get();;\n        return view('main.peminjaman_kendaraan.print', [\n            'title' => 'Laporan Data Peminjaman Ruang',\n            'result' => $row,\n            'tgl_a' => $tgl_a,\n            'tgl_b' => $tgl_b,\n        ]);\n    }\n}\n"
        }
    ]
}