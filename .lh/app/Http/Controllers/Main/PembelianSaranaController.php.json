{
    "sourceFile": "app/Http/Controllers/Main/PembelianSaranaController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 11,
            "patches": [
                {
                    "date": 1705405624363,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1705405822395,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,16 +18,16 @@\n     {\n         if ($user = auth()->user()->jab_id == 4) {\n             $user = auth()->user()->id;\n             $data['title'] = 'Data pengajuan pembelian sarana';\n-            $user = PembelianSarana::with('users', 'kelompok', 'sarana')\n+            $user = PembelianSarana::with('users', 'kelompok')\n                 ->where('user_id', $user)\n                 ->get();\n             $data['result'] = $user->sortDesc();\n             return view('main.pembelian_sarana.index', $data);\n         } else {\n             $data['title'] = 'Data pengajuan pembelian sarana';\n-            $user = PembelianSarana::with('users', 'kelompok', 'sarana')\n+            $user = PembelianSarana::with('users', 'kelompok')\n                 ->get();\n             $data['result'] = $user->sortDesc();\n             return view('main.pembelian_sarana.index', $data);\n         }\n"
                },
                {
                    "date": 1705406148203,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,10 @@\n         $request->validate([\n             'file1' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'kelompok_id' => 'required',\n-            'sarana_id' => 'required',\n+            'sarana' => 'required',\n+            'spesifikasi' => 'required',\n             'harga' => 'required',\n             'keterangan' => 'required',\n             'jumlah' => 'required',\n             'tanggal' => 'required',\n@@ -71,9 +72,10 @@\n         $fileModel = new PembelianSarana();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->kelompok_id = $request->kelompok_id;\n-        $fileModel->sarana_id = $request->sarana_id;\n+        $fileModel->sarana = $request->sarana;\n+        $fileModel->spesifikasi = $request->spesifikasi;\n         $fileModel->harga = $request->harga;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->jumlah = $request->jumlah;\n         $fileModel->Paraf = $file1Name;\n@@ -93,9 +95,10 @@\n         $row = PembelianSarana::findOrFail($id);\n         return view('main.pembelian_sarana.show', [\n             'title' => 'Detail Data Pembelian Sarana',\n             'kelompok_id' => $row->kelompok_id,\n-            'sarana_id' => $row->sarana_id,\n+            'sarana' => $row->sarana,\n+            'spesifikasi' => $row->spesifikasi,\n             'harga' => $row->harga,\n             'keterangan' => $row->keterangan,\n             'jumlah' => $row->jumlah,\n             'Paraf' => $row->Paraf,\n"
                },
                {
                    "date": 1705406231446,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -120,9 +120,10 @@\n             'title' => 'Edit Data Sarpras',\n             'user' => $user,\n             'id' => $row->id,\n             'kelompok' => $kelompok,\n-            'sarana' => $sarana,\n+            'sarana' => $row->sarana,\n+            'spesifikasi' => $row->spesifikasi,\n             'harga' => $row->harga,\n             'keterangan' => $row->keterangan,\n             'jumlah' => $row->jumlah,\n             'tanggal' => $row->tanggal,\n"
                },
                {
                    "date": 1705406268464,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -141,9 +141,10 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'kelompok_id' => 'required',\n-            'sarana_id' => 'required',\n+            'sarana' => 'required',\n+            'spesifikasi' => 'required',\n             'harga' => 'required',\n             'keterangan' => 'required',\n             'jumlah' => 'required',\n             'tanggal' => 'required',\n"
                },
                {
                    "date": 1705406305103,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,9 +158,10 @@\n \n         $fileModel = PembelianSarana::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->kelompok_id = $request->kelompok_id;\n-        $fileModel->sarana_id = $request->sarana_id;\n+        $fileModel->sarana = $request->sarana;\n+        $fileModel->spesifikasi = $request->spesifikasi;\n         $fileModel->harga = $request->harga;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->jumlah = $request->jumlah;\n         $fileModel->tanggal = $request->tanggal;\n"
                },
                {
                    "date": 1705406377058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -178,12 +178,12 @@\n     public function destroy(string $id)\n     {\n \n         $data = PembelianSarana::findOrFail($id);\n-        $image_path = \"/uploads/\" . $data->paraf;\n+        $file_path = \"/uploads/\" . $data->paraf;\n \n-        if (file_exists($image_path)) {\n-            @unlink($image_path);\n+        if (file_exists($file_path)) {\n+            @unlink($file_path);\n         }\n         $data->delete();\n         return back()->with('hapus', 'Data sudah di Hapus!');\n     }\n"
                },
                {
                    "date": 1705449046200,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,9 @@\n      */\n     public function store(Request $request)\n     {\n         $request->validate([\n-            'file1' => 'required|mimes:jpg,png|max:5048',\n+            'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n             'kelompok_id' => 'required',\n             'sarana' => 'required',\n             'spesifikasi' => 'required',\n"
                },
                {
                    "date": 1705450290895,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,8 @@\n \n namespace App\\Http\\Controllers\\Main;\n \n use App\\Http\\Controllers\\Controller;\n-use App\\Models\\Sarana;\n use App\\Models\\Kelompok;\n use App\\Models\\PembelianSarana;\n use App\\Models\\User;\n use Illuminate\\Http\\Request;\n@@ -39,9 +38,8 @@\n     public function create()\n     {\n         $data['user'] = User::all();\n         $data['kelompok'] = Kelompok::all();\n-        $data['sarana'] = Sarana::all();\n         $data['pembelian_sarana'] = PembelianSarana::all();\n         $data['title'] = \"Tambah Data Pembelian Sarana\";\n         return view(\"main.pembelian_sarana.create\", $data);\n     }\n@@ -63,11 +61,12 @@\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n         // Proses pengunggahan berkas pertama\n-        $file1 = $request->file('file1');\n-        $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        $file1->move(public_path('uploads'), $file1Name);\n+        // Proses pengunggahan berkas kedua\n+        $file2 = $request->file('file2');\n+        $file2Name = time() . '_' . $file2->getClientOriginalName();\n+        $file2->move(public_path('uploads'), $file2Name);\n \n \n         $fileModel = new PembelianSarana();\n \n@@ -77,9 +76,9 @@\n         $fileModel->spesifikasi = $request->spesifikasi;\n         $fileModel->harga = $request->harga;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->jumlah = $request->jumlah;\n-        $fileModel->Paraf = $file1Name;\n+        $fileModel->Paraf = $file2Name;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n         $fileModel->save();\n@@ -114,10 +113,9 @@\n \n         $row = PembelianSarana::findOrFail($id);\n         $user = User::all();\n         $kelompok = Kelompok::all();\n-        $sarana = Sarana::all();\n-        return view('main.pembelian_sarpras.edit', [\n+        return view('main.pembelian_sarana.edit', [\n             'title' => 'Edit Data Sarpras',\n             'user' => $user,\n             'id' => $row->id,\n             'kelompok' => $kelompok,\n@@ -178,12 +176,12 @@\n     public function destroy(string $id)\n     {\n \n         $data = PembelianSarana::findOrFail($id);\n-        $file_path = \"/uploads/\" . $data->paraf;\n+        $paraf = \"/uploads/\" . $data->paraf;\n \n-        if (file_exists($file_path)) {\n-            @unlink($file_path);\n+        if (file_exists($paraf)) {\n+            @unlink($paraf);\n         }\n         $data->delete();\n         return back()->with('hapus', 'Data sudah di Hapus!');\n     }\n"
                },
                {
                    "date": 1705467095697,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,188 +0,0 @@\n-<?php\n-\n-namespace App\\Http\\Controllers\\Main;\n-\n-use App\\Http\\Controllers\\Controller;\n-use App\\Models\\Kelompok;\n-use App\\Models\\PembelianSarana;\n-use App\\Models\\User;\n-use Illuminate\\Http\\Request;\n-\n-class PembelianSaranaController extends Controller\n-{\n-    /**\n-     * Display a listing of the resource.\n-     */\n-    public function index()\n-    {\n-        if ($user = auth()->user()->jab_id == 4) {\n-            $user = auth()->user()->id;\n-            $data['title'] = 'Data pengajuan pembelian sarana';\n-            $user = PembelianSarana::with('users', 'kelompok')\n-                ->where('user_id', $user)\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pembelian_sarana.index', $data);\n-        } else {\n-            $data['title'] = 'Data pengajuan pembelian sarana';\n-            $user = PembelianSarana::with('users', 'kelompok')\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pembelian_sarana.index', $data);\n-        }\n-    }\n-\n-    /**\n-     * Show the form for creating a new resource.\n-     */\n-    public function create()\n-    {\n-        $data['user'] = User::all();\n-        $data['kelompok'] = Kelompok::all();\n-        $data['pembelian_sarana'] = PembelianSarana::all();\n-        $data['title'] = \"Tambah Data Pembelian Sarana\";\n-        return view(\"main.pembelian_sarana.create\", $data);\n-    }\n-\n-    /**\n-     * Store a newly created resource in storage.\n-     */\n-    public function store(Request $request)\n-    {\n-        $request->validate([\n-            'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n-            'user_id' => 'required',\n-            'kelompok_id' => 'required',\n-            'sarana' => 'required',\n-            'spesifikasi' => 'required',\n-            'harga' => 'required',\n-            'keterangan' => 'required',\n-            'jumlah' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // Proses pengunggahan berkas pertama\n-        // Proses pengunggahan berkas kedua\n-        $file2 = $request->file('file2');\n-        $file2Name = time() . '_' . $file2->getClientOriginalName();\n-        $file2->move(public_path('uploads'), $file2Name);\n-\n-\n-        $fileModel = new PembelianSarana();\n-\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->kelompok_id = $request->kelompok_id;\n-        $fileModel->sarana = $request->sarana;\n-        $fileModel->spesifikasi = $request->spesifikasi;\n-        $fileModel->harga = $request->harga;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->jumlah = $request->jumlah;\n-        $fileModel->Paraf = $file2Name;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-        return redirect('main/pembelian_sarana')->with('success', 'Data berhasil di simpan.');\n-    }\n-\n-    /**\n-     * Display the specified resource.\n-     */\n-    public function show(string $id)\n-    {\n-\n-        $row = PembelianSarana::findOrFail($id);\n-        return view('main.pembelian_sarana.show', [\n-            'title' => 'Detail Data Pembelian Sarana',\n-            'kelompok_id' => $row->kelompok_id,\n-            'sarana' => $row->sarana,\n-            'spesifikasi' => $row->spesifikasi,\n-            'harga' => $row->harga,\n-            'keterangan' => $row->keterangan,\n-            'jumlah' => $row->jumlah,\n-            'Paraf' => $row->Paraf,\n-            'tanggal' => $row->tanggal,\n-        ]);\n-    }\n-\n-    /**\n-     * Show the form for editing the specified resource.\n-     */\n-    public function edit(string $id)\n-    {\n-\n-        $row = PembelianSarana::findOrFail($id);\n-        $user = User::all();\n-        $kelompok = Kelompok::all();\n-        return view('main.pembelian_sarana.edit', [\n-            'title' => 'Edit Data Sarpras',\n-            'user' => $user,\n-            'id' => $row->id,\n-            'kelompok' => $kelompok,\n-            'sarana' => $row->sarana,\n-            'spesifikasi' => $row->spesifikasi,\n-            'harga' => $row->harga,\n-            'keterangan' => $row->keterangan,\n-            'jumlah' => $row->jumlah,\n-            'tanggal' => $row->tanggal,\n-            'status' => $row->status,\n-        ]);\n-    }\n-\n-    /**\n-     * Update the specified resource in storage.\n-     */\n-    public function update(Request $request, string $id)\n-    {\n-        $request->validate([\n-            // 'file1' => 'required|mimes:jpg,png|max:5048',\n-            // 'file2' => 'required|mimes:jpg,png|max:5048',\n-            // 'file3' => 'required|mimes:jpg,png|max:5048',\n-            'user_id' => 'required',\n-            'kelompok_id' => 'required',\n-            'sarana' => 'required',\n-            'spesifikasi' => 'required',\n-            'harga' => 'required',\n-            'keterangan' => 'required',\n-            'jumlah' => 'required',\n-            'tanggal' => 'required',\n-            'status' => 'required',\n-        ]);\n-        // // Proses pengunggahan berkas pertama\n-        // $file1 = $request->file('file1');\n-        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n-        // $file1->move(public_path('uploads'), $file1Name);\n-\n-\n-        $fileModel = PembelianSarana::find($id);\n-        $fileModel->user_id = $request->user_id;\n-        $fileModel->kelompok_id = $request->kelompok_id;\n-        $fileModel->sarana = $request->sarana;\n-        $fileModel->spesifikasi = $request->spesifikasi;\n-        $fileModel->harga = $request->harga;\n-        $fileModel->keterangan = $request->keterangan;\n-        $fileModel->jumlah = $request->jumlah;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->status = $request->status;\n-\n-        $fileModel->save();\n-\n-        return redirect('main/pembelian_sarana')->with('success', 'Data berhasil diubah');\n-    }\n-\n-    /**\n-     * Remove the specified resource from storage.\n-     */\n-    public function destroy(string $id)\n-    {\n-\n-        $data = PembelianSarana::findOrFail($id);\n-        $paraf = \"/uploads/\" . $data->paraf;\n-\n-        if (file_exists($paraf)) {\n-            @unlink($paraf);\n-        }\n-        $data->delete();\n-        return back()->with('hapus', 'Data sudah di Hapus!');\n-    }\n-}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1706070573537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,47 +2,36 @@\n \n namespace App\\Http\\Controllers\\Main;\n \n use App\\Http\\Controllers\\Controller;\n-use App\\Models\\JenisKebutuhan;\n-use App\\Models\\PembelianSarpras;\n+use App\\Models\\Sarana;\n+use App\\Models\\PembelianSarana;\n use App\\Models\\User;\n use Faker\\Core\\File;\n use Illuminate\\Http\\Request;\n \n-class PembelianSarprasController extends Controller\n+class PembelianSaranaController extends Controller\n {\n     /**\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        if ($user = auth()->user()->jab_id == 4) {\n-            $user = auth()->user()->id;\n-            $data['title'] = 'Data Pembelian Sarpras';\n-            $user = PembelianSarpras::with('users', 'jenis_kebutuhans')\n-                ->where('user_id', $user)\n-                ->get();\n+            $data['title'] = 'Data Pembelian Sarana';\n+            $user = PembelianSarana::with('users', 'sarana')->get();\n             $data['result'] = $user->sortDesc();\n-            return view('main.pembelian_sarpras.index', $data);\n-        } else {\n-            $data['title'] = 'Data Pembelian Sarpras';\n-            $user = PembelianSarpras::with('users', 'jenis_kebutuhans')\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pembelian_sarpras.index', $data);\n+            return view('main.pembelian_sarana.index', $data);\n         }\n-    }\n \n     /**\n      * Show the form for creating a new resource.\n      */\n     public function create()\n     {\n         $data['user'] = User::all();\n-        $data['jenis_kebutuhan'] = JenisKebutuhan::all();\n-        $data['title'] = \"Tambah Data Sarpras\";\n-        return view(\"main.pembelian_sarpras.create\", $data);\n+        $data['sarana'] = Sarana::all();\n+        $data['title'] = \"Tambah Data Sarana\";\n+        return view(\"main.pembelian_sarana.create\", $data);\n     }\n \n     /**\n      * Store a newly created resource in storage.\n@@ -50,69 +39,49 @@\n     public function store(Request $request)\n     {\n         $request->validate([\n             'file1' => 'required|mimes:jpg,png|max:5048',\n-            'file2' => 'required|mimes:jpg,png|max:5048',\n-            'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n-            'nama' => 'required',\n-            'jenis_kebutuhan' => 'required',\n-            'spesifikasi' => 'required',\n-            'jumlah' => 'required',\n-            'harga_satuan' => 'required',\n+            'sarana_id' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n             'status' => 'required',\n-            'tanggal' => 'required',\n         ]);\n+\n         // Proses pengunggahan berkas pertama\n         $file1 = $request->file('file1');\n         $file1Name = time() . '_' . $file1->getClientOriginalName();\n         $file1->move(public_path('uploads'), $file1Name);\n \n-        // Proses pengunggahan berkas kedua\n-        $file2 = $request->file('file2');\n-        $file2Name = time() . '_' . $file2->getClientOriginalName();\n-        $file2->move(public_path('uploads'), $file2Name);\n \n-        // Proses pengunggahan berkas ketiga\n-        $file3 = $request->file('file3');\n-        $file3Name = time() . '_' . $file3->getClientOriginalName();\n-        $file3->move(public_path('uploads'), $file3Name);\n \n-        $fileModel = new PembelianSarpras();\n+        $fileModel = new PembelianSarana();\n \n         $fileModel->user_id = $request->user_id;\n         $fileModel->nama = $request->nama;\n-        $fileModel->jenis_kebutuhan = $request->jenis_kebutuhan;\n-        $fileModel->spesifikasi = $request->spesifikasi;\n-        $fileModel->jumlah = $request->jumlah;\n-        $fileModel->harga_satuan = $request->harga_satuan;\n+        $fileModel->sarana_id = $request->sarana_id;\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->tanggal = $request->tanggal;\n-        $fileModel->gambar_katalog = $file1Name;\n-        $fileModel->paraf_kapokja = $file2Name;\n-        $fileModel->gambar_pembelian = $file3Name;\n+        $fileModel->katalog = $file1Name;\n \n         $fileModel->save();\n-        return redirect('main/pembelian_sarpras')->with('success', 'Data berhasil di simpan.');\n+        return redirect('main/pembelian_sarana')->with('success', 'Data berhasil di simpan.');\n     }\n \n     /**\n      * Display the specified resource.\n      */\n     public function show(string $id)\n     {\n \n-        $row = PembelianSarpras::findOrFail($id);\n+        $row = PembelianSarana::findOrFail($id);\n         return view('main.pembelian_sarpras.show', [\n-            'title' => 'Detail Data Pembelian Sarpras',\n-            'nama' => $row->nama,\n-            'jenis_kebutuhan' => $row->jenis_kebutuhan,\n-            'spesifikasi' => $row->spesifikasi,\n-            'jumlah' => $row->jumlah,\n-            'harga_satuan' => $row->harga_satuan,\n-            'gambar_katalog' => $row->gambar_katalog,\n-            'paraf_kapokja' => $row->paraf_kapokja,\n-            'gambar_pembelian' => $row->gambar_pembelian,\n+            'title' => 'Detail Data Pembelian Sarana',\n+            'sarana_id' => $row->sarana_id,\n+            'keterangan' => $row->keterangan,\n+            'tanggal' => $row->tanggal,\n+            'katalog' => $row->katalog,\n         ]);\n     }\n \n     /**\n@@ -120,22 +89,20 @@\n      */\n     public function edit(string $id)\n     {\n \n-        $row = PembelianSarpras::findOrFail($id);\n+        $row = PembelianSarana::findOrFail($id);\n         $user = User::all();\n-        $jenis_kebutuhan = JenisKebutuhan::all();\n-        return view('main.pembelian_sarpras.edit', [\n-            'title' => 'Edit Data Sarpras',\n+        $sarana = Sarana::all();\n+        return view('main.pembelian_sarana.edit', [\n+            'title' => 'Edit Data Sarana',\n             'user' => $user,\n             'id' => $row->id,\n             'nama' => $row->nama,\n-            'jenis_kebutuhan' => $jenis_kebutuhan,\n-            'spesifikasi' => $row->spesifikasi,\n-            'jumlah' => $row->jumlah,\n-            'harga_satuan' => $row->harga_satuan,\n+            'sarana' => $sarana,\n+            'keterangan' => $row->keterangan,\n+            'tanggal' => $row->tanggal,\n             'status' => $row->status,\n-            'tanggal' => $row->tanggal,\n         ]);\n     }\n \n     /**\n@@ -148,14 +115,12 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'nama' => 'required',\n-            'jenis_kebutuhan' => 'required',\n-            'spesifikasi' => 'required',\n-            'jumlah' => 'required',\n-            'harga_satuan' => 'required',\n+            'sarana_id' => 'required',\n+            'keterangan' => 'required',\n+            'tanggal' => 'required',\n             'status' => 'required',\n-            'tanggal' => 'required',\n         ]);\n         // // Proses pengunggahan berkas pertama\n         // $file1 = $request->file('file1');\n         // $file1Name = time() . '_' . $file1->getClientOriginalName();\n"
                },
                {
                    "date": 1706070724787,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,9 @@\n     public function show(string $id)\n     {\n \n         $row = PembelianSarana::findOrFail($id);\n-        return view('main.pembelian_sarpras.show', [\n+        return view('main.pembelian_sarana.show', [\n             'title' => 'Detail Data Pembelian Sarana',\n             'sarana_id' => $row->sarana_id,\n             'keterangan' => $row->keterangan,\n             'tanggal' => $row->tanggal,\n@@ -125,34 +125,21 @@\n         // $file1 = $request->file('file1');\n         // $file1Name = time() . '_' . $file1->getClientOriginalName();\n         // $file1->move(public_path('uploads'), $file1Name);\n \n-        // // Proses pengunggahan berkas kedua\n-        // $file2 = $request->file('file2');\n-        // $file2Name = time() . '_' . $file2->getClientOriginalName();\n-        // $file2->move(public_path('uploads'), $file2Name);\n \n-        // // Proses pengunggahan berkas ketiga\n-        // $file3 = $request->file('file3');\n-        // $file3Name = time() . '_' . $file3->getClientOriginalName();\n-        // $file3->move(public_path('uploads'), $file3Name);\n-\n-        $fileModel = PembelianSarpras::find($id);\n+        $fileModel = PembelianSarana::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->nama = $request->nama;\n-        $fileModel->jenis_kebutuhan = $request->jenis_kebutuhan;\n-        $fileModel->spesifikasi = $request->spesifikasi;\n-        $fileModel->jumlah = $request->jumlah;\n-        $fileModel->harga_satuan = $request->harga_satuan;\n+        $fileModel->sarana_id = $request->sarana_id;\n+        $fileModel->keterangan = $request->keterangan;\n+        $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->tanggal = $request->tanggal;\n-        // $fileModel->gambar_katalog = $file1Name;\n-        // $fileModel->paraf_kapokja = $file2Name;\n-        // $fileModel->gambar_pembelian = $file3Name;\n+        // $fileModel->katalog = $file1Name;\n \n         $fileModel->save();\n \n-        return redirect('main/pembelian_sarpras')->with('success', 'Data berhasil diubah');\n+        return redirect('main/pembelian_sarana')->with('success', 'Data berhasil diubah');\n     }\n \n     /**\n      * Remove the specified resource from storage.\n"
                }
            ],
            "date": 1705405624362,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\Sarana;\nuse App\\Models\\Kelompok;\nuse App\\Models\\PembelianSarana;\nuse App\\Models\\User;\nuse Illuminate\\Http\\Request;\n\nclass PembelianSaranaController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        if ($user = auth()->user()->jab_id == 4) {\n            $user = auth()->user()->id;\n            $data['title'] = 'Data pengajuan pembelian sarana';\n            $user = PembelianSarana::with('users', 'kelompok', 'sarana')\n                ->where('user_id', $user)\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pembelian_sarana.index', $data);\n        } else {\n            $data['title'] = 'Data pengajuan pembelian sarana';\n            $user = PembelianSarana::with('users', 'kelompok', 'sarana')\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pembelian_sarana.index', $data);\n        }\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['user'] = User::all();\n        $data['kelompok'] = Kelompok::all();\n        $data['sarana'] = Sarana::all();\n        $data['pembelian_sarana'] = PembelianSarana::all();\n        $data['title'] = \"Tambah Data Pembelian Sarana\";\n        return view(\"main.pembelian_sarana.create\", $data);\n    }\n\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n        $request->validate([\n            'file1' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'kelompok_id' => 'required',\n            'sarana_id' => 'required',\n            'harga' => 'required',\n            'keterangan' => 'required',\n            'jumlah' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // Proses pengunggahan berkas pertama\n        $file1 = $request->file('file1');\n        $file1Name = time() . '_' . $file1->getClientOriginalName();\n        $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = new PembelianSarana();\n\n        $fileModel->user_id = $request->user_id;\n        $fileModel->kelompok_id = $request->kelompok_id;\n        $fileModel->sarana_id = $request->sarana_id;\n        $fileModel->harga = $request->harga;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->jumlah = $request->jumlah;\n        $fileModel->Paraf = $file1Name;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n        return redirect('main/pembelian_sarana')->with('success', 'Data berhasil di simpan.');\n    }\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n\n        $row = PembelianSarana::findOrFail($id);\n        return view('main.pembelian_sarana.show', [\n            'title' => 'Detail Data Pembelian Sarana',\n            'kelompok_id' => $row->kelompok_id,\n            'sarana_id' => $row->sarana_id,\n            'harga' => $row->harga,\n            'keterangan' => $row->keterangan,\n            'jumlah' => $row->jumlah,\n            'Paraf' => $row->Paraf,\n            'tanggal' => $row->tanggal,\n        ]);\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n\n        $row = PembelianSarana::findOrFail($id);\n        $user = User::all();\n        $kelompok = Kelompok::all();\n        $sarana = Sarana::all();\n        return view('main.pembelian_sarpras.edit', [\n            'title' => 'Edit Data Sarpras',\n            'user' => $user,\n            'id' => $row->id,\n            'kelompok' => $kelompok,\n            'sarana' => $sarana,\n            'harga' => $row->harga,\n            'keterangan' => $row->keterangan,\n            'jumlah' => $row->jumlah,\n            'tanggal' => $row->tanggal,\n            'status' => $row->status,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n        $request->validate([\n            // 'file1' => 'required|mimes:jpg,png|max:5048',\n            // 'file2' => 'required|mimes:jpg,png|max:5048',\n            // 'file3' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'kelompok_id' => 'required',\n            'sarana_id' => 'required',\n            'harga' => 'required',\n            'keterangan' => 'required',\n            'jumlah' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // // Proses pengunggahan berkas pertama\n        // $file1 = $request->file('file1');\n        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n        // $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = PembelianSarana::find($id);\n        $fileModel->user_id = $request->user_id;\n        $fileModel->kelompok_id = $request->kelompok_id;\n        $fileModel->sarana_id = $request->sarana_id;\n        $fileModel->harga = $request->harga;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->jumlah = $request->jumlah;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n\n        return redirect('main/pembelian_sarana')->with('success', 'Data berhasil diubah');\n    }\n\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n\n        $data = PembelianSarana::findOrFail($id);\n        $image_path = \"/uploads/\" . $data->paraf;\n\n        if (file_exists($image_path)) {\n            @unlink($image_path);\n        }\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n}\n"
        }
    ]
}