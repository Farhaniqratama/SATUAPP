{
    "sourceFile": "app/Http/Controllers/Main/PengajuanSarprasController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1705616420110,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1705616420110,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\Barang;\nuse App\\Models\\PemeliharaanSarpras;\nuse App\\Models\\User;\nuse Illuminate\\Http\\Request;\n\nclass PengajuanSarprasController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        if (auth()->user()->jab_id == 4) {\n\n            $user = auth()->user()->id;\n            $data['title'] = 'Data pengajuan pemeliharaan sarpras';\n            $data['result'] = PemeliharaanSarpras::with('user', 'barang')\n                ->where('user_id', '=', $user)\n                ->get();\n            return view('main.pengajuan_sarpras.index', $data);\n        } else {\n            $data['title'] = 'Data pengajuan pemeliharaan sarpras';\n            $data['result'] = PemeliharaanSarpras::with('user', 'barang')\n                ->get();\n            return view('main.pengajuan_sarpras.index', $data);\n        }\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['title'] = \"Tambah Data Pengajuan Pemeliharaan Sarpras\";\n        $user = User::all();\n        $barang = Barang::all();\n        $data['result'] = $user->sortDesc();\n        $data['barang'] = $barang->sortDesc();\n        return view('main.pengajuan_sarpras.create', $data);\n    }\n\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n\n        $validasi = $this->validate(\n            $request,\n            [\n                'user_id' => 'required',\n                'barang_id' => 'required',\n                'jumlah' => 'required',\n                'keterangan' => 'required',\n                'status' => 'required',\n            ],\n            [\n                'user_id.required' => 'jenis id tidak boleh kosong',\n                'barang_id.required' => 'pengguna id tidak boleh kosong',\n                'jumlah.required' => 'jumlah tidak boleh kosong',\n                'keterangan.required' => 'keterangan tidak boleh kosong',\n                'status.required' => 'status tidak boleh kosong',\n            ]\n        );\n        PemeliharaanSarpras::create([\n            'user_id' => $request->user_id,\n            'barang_id' => $request->barang_id,\n            'jumlah' => $request->jumlah,\n            'keterangan' => $request->keterangan,\n            'status' => $request->status,\n        ]);\n\n        return redirect('main/pemeliharaan_sarpras')->with('success', 'Data berhasil disimpan!');\n    }\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n        //\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n        $row = PemeliharaanSarpras::findOrFail($id);\n        return view('main.pengajuan_sarpras.edit', [\n            'title' => 'Edit Data Pengajuan Pemeliharaan Sarpras',\n            'id' => $row->id,\n            'user_id' => $row->user_id,\n            'barang_id' => $row->barang_id,\n            'user' => User::all(),\n            'barang' => Barang::all(),\n            'nama' => $row->nama,\n            'jumlah' => $row->jumlah,\n            'keterangan' => $row->keterangan,\n            'status' => $row->status,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n        $row = PemeliharaanSarpras::find($id);\n        if ($row) {\n            $row->user_id = $request->user_id;\n            $row->barang_id = $request->barang_id;\n            $row->jumlah = $request->jumlah;\n            $row->keterangan = $request->keterangan;\n            $row->status = $request->status;\n            // Simpan perubahan\n            $row->save();\n\n            return redirect('main/pemeliharaan_sarpras')->with('success', 'Data berhasil diubah');\n        }\n    }\n\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n\n        $data = PemeliharaanSarpras::findOrFail($id);\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n}\n"
        }
    ]
}